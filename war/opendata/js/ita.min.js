"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(l,e){var a=l({});l.subscribe=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.on.apply(a,t)},l.unsubscribe=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.off.apply(a,t)},l.publish=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.trigger.apply(a,t)},l.show_events=function(){[["PUBSUB",a[0]],["BODY",document.body],["DOCUMENT",document],["WINDOW",window]].forEach(function(e){var t=_slicedToArray(e,2),n=t[0],a=t[1];console.warn(n);var r=l._data(a,"events"),o=0;for(var i in r){var s=r[i].length;console.log(s.toString().padStart(2)+" "+i,r[i].map(function(e){return e.namespace||e.selector||""})),o+=s}console.info("NUM TOTAL =",o)})},e.$o=a}(jQuery,ITA),function(e,t){var r={};e.ajaxPrefilter(function(e,t,n){var a=e.url.split("?")[0];r[a]=(r[a]||0)+1}),t.ajaxALL=r}(jQuery,ITA),ITA.util={cookie:function(e,t){if(arguments.length<2){for(var n,a=document.cookie.split(";"),r=0;r<a.length;r++)if((n=a[r].replace(/^\s+/,"")).startsWith(e+"="))return decodeURIComponent(n.substring(e.length+1).split("+").join(" "));return null}document.cookie=e+"="+encodeURIComponent(t)+";path=/"},debounce:function(a,r){var o=this,i=void 0;return function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];r?(clearTimeout(i),i=setTimeout(function(){return a.call.apply(a,[o].concat(t))},r)):(window.cancelAnimationFrame(i),i=window.requestAnimationFrame(function(){return a.call.apply(a,[o].concat(t))}))}},castArray:function(e){return Array.isArray(e)?e:null==e?[]:[e]},random:function(e,t){return void 0===t?Math.floor(Math.random()*(e+1)):Math.floor(Math.random()*(t-e+1))+e},isEmpty:function(e){return null==e||!(Object.keys(e)||e).length},maxN:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return[].concat(_toConsumableArray(e)).sort(function(e,t){return t-e}).slice(0,t)},minN:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return[].concat(_toConsumableArray(e)).sort(function(e,t){return e-t}).slice(0,t)},pickBy:function(n,t){return Object.keys(n).filter(function(e){return t(n[e],e)}).reduce(function(e,t){return e[t]=n[t],e},{})},toPairs:function(t){return Object.keys(t).map(function(e){return[e,t[e]]})},forEach:function(t,n){Object.keys(t).forEach(function(e){return n.call(t,t[e],e,t)})},map:function(t,n){return Object.keys(t).map(function(e){return n.call(t,t[e],e,t)})},h:function(e,t,n){var a=document.createElement(e);for(var r in t||{})a.setAttribute(r,t[r]);return n&&ITA.util.castArray(n).forEach(function(e){a.appendChild("string"==typeof e?document.createTextNode(e):e)}),a},empty:function(e){if("string"==typeof e&&(e=document.getElementById(e)),e&&"object"===(void 0===e?"undefined":_typeof(e))&&"firstChild"in e)for(;e.firstChild;)e.removeChild(e.firstChild);return e},get:function(e,t,n){return(t.split?t.split("."):t).reduce(function(e,t){return e&&"object"===(void 0===e?"undefined":_typeof(e))&&t in e?e[t]:n},e)},dset:function(e,t,a){var r,o=e;return(t.split?t.split("."):t).forEach(function(e,t,n){r=o[e],o=o[e]=t===n.length-1?a:null==r?{}:r}),e},append:function(e,t){if(t){if("string"==typeof t)return e.insertAdjacentHTML("beforeend",t),e.lastElementChild;e.appendChild(t)}return t},cloneDeep:function(e){return JSON.parse(JSON.stringify(e))},escapeHTML:function(e){var t=document.createElement("textarea");return t.textContent=e,t.innerHTML},unescapeHTML:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.textContent},render:function(e){var t=e.id,n=e.json,a=void 0===n?{}:n,r=e.$target[0],o=Object.assign({},this.default||{},"object"===_typeof(a.value)?a.value:a,{id:t}),i=$(this.template?this.template(o):null);return this.beforeMount&&this.beforeMount(r,i,o,a),i.appendTo(r),[this.$_mounted?this.$_mounted(i[0],o,a):ITA.$_RESOLVED,i]},showJsonCode:function(e){var t=window.open("html/sourcecode.html","_blank");t.document.open(),t.document.write("<!doctype html><html><head></head><body><pre><code>"+JSON.stringify(e,null,4)+"</code></pre></body></html>"),t.document.close(),t.focus()},set_elem_height_to_avoid_parents_scrollbars:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!e)return 0;var n=0,a=e.style;for(a.maxHeight=a.height="1500px";e.parentElement;)n+=(e=e.parentElement).scrollHeight-e.offsetHeight;return a.maxHeight=a.height=1500-n-t+"px",a.height},if:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";return e?t:n},tag:function(e,t,n){return null!=t?" "+e+'="'+t+'" ':null!=n?" "+e+'="'+n+'" ':""},getEndpoint:function(e,t,n){var a=e.endpoint,r=e.endpoints;if(r)if(t in r)a=r[t],t="";else{if(a=r["*"],"~"in r)for(var o in r["~"])t.includes(o)&&(a=r["~"][o]);if("^"in r)for(var i in r["^"])t.startsWith(i)&&(a=r["^"][i])}if(a){var s=a,l=s.url,c=s.altQueryString,u=void 0===c?"":c,d=s.method,p=void 0===d?"POST":d,f=s.auth,m=void 0!==f&&f,g=s.jsonp;return{url:l+(t||u),method:p,auth:m,data:n,jsonp:void 0!==g&&g}}console.warn("no existe 'endpoint' definido en 'ita.configuration.js'")}},ITA.widget={debug:{template:function(e){return'<div class="vmp-debug-toolbar btn-group btn-group-xs debug-off-hidden" role="group" aria-label="..."><button type="button" data-index="'+e+'" class="btn btn-warning" title="ver código JSON" onclick="ITA.widget.debug.click(this)"><span class="fa fa-code"></span> JSON</button></div>'},click:function(e){var t=e.dataset.index,n=ITA.idSeparator,a=ITA.permanent.idSeparator,r=n;0===t.indexOf("0"+a)?(t=t.substr(a.length+1),r=a):0===t.indexOf("0"+n)&&(t=t.substr(n.length+1)),console.warn(t,r,e),ITA.util.showJsonCode(ITA.getContentByKey(t,r))}}},window.addEventListener("resize",ITA.util.debounce(function(){$.publish("resizeend")},250)),Object.assign(ITA,function(){var e,t,n,r={},o=$.when(),i=function(e){return-1===e.indexOf("//")&&ITA.project.domain?ITA.project.domain+e:e},a=/js\/widgets\/ita.items\.(.*)\.min\.js/,s={js:function(e,t){var n=e.match(a)||[];return(t||n[1])in ITA.widget?o:(void 0===r[e]&&(r[e]=$.ajax({url:i(e),dataType:"script",cache:!0}).then(function(){delete r[e],r[e]=o})),r[e])},css:function(e,t){var n="";if(void 0===r[e]){var a=-1<e.indexOf("<style")?e:'<link rel="stylesheet" href="'+i(e)+n+'" >';$(a).appendTo("head"),r[e]=o}return r[e]}},l=function(){var t=ITA.util;this.pageJSON.map(function(e){return t.empty(e.target)});return this.renderContent(this.pageJSON,$(t.empty(this.target.panels)),0).then(this.isRenderedPage)},c=function(e,i,t){var a=this,s=null!=t?t+a.idSeparator:null;e=(e||[]).reduce(function(e,t,n){if("target"in t||i){var a=$((o=t.target,document.getElementById(o)||document.getElementsByClassName(o)[0]||i));a instanceof jQuery&&a.length?e.push([(r=n,s&&s+r),t,a]):console.warn("ERROR, el target: "+(t.target||i)+" de este componente, no existe en el DOM",t,i)}else console.warn('ERROR, este componente JSON no tiene asignado "target"',t);var r,o;return e},[]);return e.reduce(function(e,n){return e.then(function(){return e=n,t=a.renderComponent.apply(a,_toConsumableArray(e)),a.promises.push(t),a.modes.push(e[1].mode),t;var e,t})},o).then(a.isRenderedAll)},u=function(o,i,s){var l=this,c=i.mode,u=i.target,d=i.id,e=i.col12,p=void 0===e?12:e,t=i.offset,f=void 0===t?"":t,n=i.classname,m=void 0===n?"":n,a=i.value,r=void 0===a?{}:a,g=i.content,v=void 0===g?[]:g;void 0===c&&(c=i.mode=v.length?"panel":"value");var h=r.target;u=void 0===h?u:h;var b=r.id;return d=void 0===b?d||"id_"+c+"_"+ITA.util.random(9999):b,ITA.js("js/widgets/ita.items."+c+".min.js",c).then(function(){var e,a=ITA.widget[c],r=null;return(e=$).when.apply(e,_toConsumableArray(ITA.load(a.dependencies))).then(function(){var e=document.getElementById("container-"+u)||document.getElementById(u)||s[0];if(e&&e.classList.contains("row")){var t=document.createElement("div");o&&t.setAttribute("id",o),t.className="col-md-"+p+" vmp-mode-"+c,f&&(t.className+=" col-md-offset-"+f),m&&(t.className+=" "+m),e.appendChild(t),e=t}var n=a.render({id:d,index:o,json:i,$target:$(e)});return Array.isArray(n)?(r=$(n[1]),n[0]):n}).then(function(e){if(v.length){var t=r||e,n=t.is(ITA.target.contents)?t:t.find(ITA.target.contents);return l.renderContent(v,n,o)}return r})})},d=function(){return o},p=function(e){var t=this;t.destroyPage().then(function(){e&&(t.pageJSON=e),t.createPage()})},f=function(e,t){var n=e.split(t),a=t===this.permanent.idSeparator?this.permanent:this;return n.forEach(function(e,t){a=a[0<t?"content":"pageJSON"][1*e]}),a},m=function(){return{target:{namespace:"ita-target-",contents:".js-ita-contents",title:".ita-project",panels:"ita-target-main",classname:{contents:"js-ita-contents"}},panels:[],promises:[],modes:[],pageJSON:null,createPage:l,renderContent:c,renderComponent:u,refreshPage:p,destroyPage:d,getContentByKey:f}},g=Object.assign(m(),{iam:"permanent.",idSeparator:"___"}),v={$_RESOLVED:o,iam:"",idSeparator:"_",querystring:[],permanent:g,ajaxNOPROXY:function(e,t){var n=ITA.util.getEndpoint(ITA.project,e,t),a=n.jsonp||!1,r=ITA.project.withCredentials||!1,o={url:n.url,type:n.method,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:t};return r&&(o.xhrFields={withCredentials:!0},o.crossDomain=!0),a&&(o={dataType:"jsonp",url:n.url}),$.ajax(o)},fetch:function(e,t,n,a){return ITA.project.proxy?$.ajax({type:"POST",url:e,data:a}):ITA.ajaxNOPROXY(t,a)},ajax:function(e){var t=this.project,n=t.urljson,a=t.ajax,r=void 0===a?"":a,o=t.home,i=void 0===o?"":o;if(n&&(e.endsWith(".json")||e.includes(".json?")))return this.$_fetchJSON(n+e);if(r.startsWith("json")){var s=r+(e.split("&").reverse()[0].replace("=","_")||i)+".json?"+Math.random();return this.$_fetchJSON(s)}return r&&ITA.project.proxy?this.$_fetchJSON(r+"?"+e,{method:"post",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}):this.ajaxNOPROXY(e)},setHistory:function(e){if("history"in window&&"pushState"in window.history){var t=e.length?"?"+e:document.location.href.split("?")[0];history.pushState("",ITA.project.label,t)}},project:(e="vmp.activeproject",t=ITA.config.projects,n=sessionStorage[e]&&sessionStorage.getItem(e)in t?sessionStorage.getItem(e):Object.keys(ITA.config.projects)[0],ITA.util.cookie("vmp.project",n),t[n]),cache:r,js:s.js,load:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(r).map(function(e){return t=r[e],"js"===(n=e)||"sync"===a?t.reduce(function(e,t){return e.then(function(){return s[n](t)})},$().promise()):t.map(function(e){return s[n](e)});var t,n,a})},unloadCss:function(e){e.forEach(function(e,t){e in r&&delete r[e],$("link[href='"+e+"']").remove()})},$_fetchValidate:function(e){if(e.ok)return e;throw e},$_fetchError:function(e){console.error(e)},$_fetchHTML:function(e){return fetch(e).then(ITA.$_fetchValidate).then(function(e){return e.text()}).catch(ITA.$_fetchError)},$_fetchJSON:function(e,t){return fetch(e,t).then(ITA.$_fetchValidate).then(function(e){return e.json()}).catch(ITA.$_fetchError)},getPageJSON:function(e,t){var n=this;if(t){var a=this.project.permanent;a?$[a.startsWith("json")?"get":"post"](a).then(function(e){n.permanent.pageJSON=e,n.permanent.createPage()}):delete this.permanent}this.ajax(e).then(function(e){n.pageJSON=e,n.createPage()})},isRenderedAll:ITA.util.debounce(function(){var e;return(e=$).when.apply(e,_toConsumableArray(ITA.promises)).then(function(){$.publish("vmp.rendered"),ITA.promises=[]})},850),isRenderedPage:function(e){return $.publish("vmp.renderedPage"),e},getNewPage:function(e,t){var n=this,a=[];return a.push(this.project.ajax),t&&a.push(t),this.$_fetchJSON(a.join("?"),{method:"post",credentials:"include",body:e,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){_.isEqual(e,n.pageJSON)||n.refreshPage(e)})}};return Object.assign(m(),v)}()),document.getElementsByTagName("title")[0].innerHTML=ITA.project.label,$("html").addClass("project-"+ITA.project.id).attr("data-project",ITA.project.id).attr("data-page",document.location.search.substr(1)).addClass(function(){try{return window.self!==window.top?"vmp-iframed":""}catch(e){return"vmp-iframed"}}());var _GET=ITA.util.get;if(_GET(ITA,"project.dependencies",!1)?ITA.load(ITA.project.dependencies):_GET(ITA,"project.theme",!1)&&(ITA.theme=ITA.project.theme,ITA.theme in ITA.config.themes?ITA.load(ITA.config.themes[ITA.theme].dependencies,"vmp-theme"):console.error("ERROR!!: el tema: '"+ITA.theme+"' no existe en ITA.config.themes: ",ITA.config.themes)),_GET(ITA,"project.debuggable",!1)){var o={mode:"config",hasTHEMES:1<Object.keys(ITA.config.themes||{}).length,hasPROJECTS:1<Object.keys(ITA.config.projects).length,hasDEBUG:ITA.project.debuggable};(o.hasTHEMES||o.hasPROJECTS||o.hasDEBUG)&&setTimeout(function(){return ITA.renderComponent("myconfig",o,$("body"))},500)}_GET(ITA,"project.layout",!1)?ITA.$_fetchHTML(ITA.project.layout).then(function(e){$(document.getElementById("ita-target-layout")).html(e),ITA.getPageJSON(document.location.search.substr(1),!0)}):ITA.getPageJSON(document.location.search.substr(1),!0),ITA.widget.block={default:{id:null,classname:""},template:function(e){var t=e.id,n=e.classname,a=e.flavor;return'<div id="'+t+'" class="ita-'+(void 0===a?"block":a)+" row js-ita-contents js-vmp-component-body clearfix "+n+'"></div>'},render:ITA.util.render},ITA.widget.config={dependencies:{css:["<style>.vmp-mode-config{position: absolute;left: 0;top: 0;}.vmp-config{font-size: 1.4rem;position: fixed;right: -24em;color: #555;background-color: #fff;z-index: 9999;padding: .5em 1em .5em .5em;box-shadow: .1em .1em 1em .3em rgb(125,125,125);transition: all 500ms ease 500ms;cursor: pointer;}.vmp-config:hover{right: 0;}.vmp-config-positioner{float: right;margin: -.5em -1em -.5em 0;background-color: #07a;padding: .5em;}.vmp-config-opener{float: left;margin: -.5em 0 -.5em -.5em;background-color: #07a;padding: 1.8em .4em;}.vmp-config-opener i,.vmp-config-positioner i{color: #fff;}.vmp-config-group{margin: 0 .5em;display: inline-block;}.vmp-config-label{color: #07a;font-weight: normal;font-size: .9em;}.vmp-config-select{max-width: 12em;}.vmp-config-down{bottom: 0;}.vmp-config-left{right: auto;left: -24em;}.vmp-config-left:hover{right: auto;left: 0;}.vmp-config-left .vmp-config-positioner{float: left;margin: -.5em 0 -.5em -.5em;}.vmp-config-left .vmp-config-opener{float: right;margin: -.5em -1em -.5em 0em;}/** * debug toolbar */ .vmp-debug-toolbar{ position: absolute; z-index: 9999; } .debug-off .debug-off-hidden, .debug-on.debug-on-hidden { display: none !important; visibility: hidden !important; }</style>"]},template:function(e){var t=e.param,n=e.name,a=e.form,r=e.icon,o=void 0===r?"":r,i=e.selected,s=void 0===i?"":i,l=e.value,c=ITA.util.tag;ITA.util.if;return'<div class="vmp-config-group"><label class=" vmp-config-label" for="config_'+t+'"><i class="glyphicon glyphicon-'+o+'"></i> '+n+':</label><br><select id="config_'+t+'" name="'+t+'"'+(a=c("form",a))+'class="vmp-config-select" data-param="'+t+'" title="Selecciona '+t+'">'+function(){var e=[];for(var t in l)e.push('<option value="'+t+'"'+(s===t?" selected":"")+">"+l[t]+"</option>");return e.join("")}()+"</select></div>"},render:function(e){var t=e.json,n=e.$target,a=$('<form id="vmp-config" class="form-inline vmp-config"><div class="vmp-config-positioner"><span class="fa-stack" title="move right / left" onclick="$(this).closest(\'.vmp-config\').toggleClass(\'vmp-config-left\')"><i class="fa fa-square-o fa-stack-2x"></i><i class="fa fa-arrows-h fa-stack-1x"></i></span><br><span class="fa-stack" title="move top / bottom" onclick="$(this).closest(\'.vmp-config\').toggleClass(\'vmp-config-down\')"><i class="fa fa-square-o fa-stack-2x"></i><i class="fa fa-arrows-v fa-stack-1x"></i></span></div><div class="vmp-config-opener"><i class="fa fa-arrow-left"></i></div></form>'),r=(t.hasTHEMES,t.hasPROJECTS),o=t.hasDEBUG;if(a.prependTo(n),r){var i=ITA.config.projects;$(this.template({name:"Proyecto ITA",value:Object.keys(i).reduce(function(e,t){return e[t]=i[t].label||t,e},{}),param:"project",icon:"cog",selected:ITA.project.id})).appendTo(a).on("change",function(e){ITA.setHistory(""),$.when(ITA.destroyPage(),!("permanent"in ITA)||ITA.permanent.destroyPage()).done(function(){sessionStorage.setItem("vmp.activeproject",e.target.value),document.location.reload(!1)})})}return o&&$(this.template({name:"Modo debug",value:{off:"Debug OFF",on:"Debug ON"},param:"debug",icon:"wrench",selected:"off"})).appendTo(a).on("change",function(e){$("html").removeClass("debug-off debug-on").addClass("debug-"+e.target.value)}),[n.promise(),a]}},ITA.widget.datatable={dependencies:{js:["js/widgets/ita.items.table.min.js","vendor/bootstrap-datatables/v1.10.15/jquery.dataTables.min.js","vendor/bootstrap-datatables/v1.10.15/dataTables.bootstrap.min.js"],css:["vendor/bootstrap-datatables/v1.10.15/dataTables.bootstrap.min.css"]},default:{id:null,col:[],thead:[],tbody:[],tfoot:[],caption:"",classname:{thead:"",tbody:"",tfoot:"",table:""},style:{thead:"",tbody:"",tfoot:"",table:""},classnameCaption:"",options:{searching:!1,searchingbycolumn:!1,paging:!1,info:!1,autowidth:!1,scrollX:!0,scrollCollapse:!0}},template:function(e){return'<div class="table-ita" id="'+e.id+'"></div>'},render:function(e){var i=e.id,t=e.json,n=e.$target,s=$.Deferred(),a=t.value,l=10<a.tbody.length,r=a.options||{},o=function(e,t){return e in r?r[e]:t},c=$('<div class="table-ita" id="'+i+'"></div>').appendTo(n),u=Object.assign({},this.default.options,{searching:o("searching",o("searchingbycolumn",l)),paging:o("paging",l),info:o("info",l),autoWidth:o("autoWidth",l)},r),d=ITA.widget;d.fn;u.searchingbycolumn&&a.thead.unshift(a.thead[0].map(function(e){return'<input class="form-control vmp-datatable-searchcolumn" style="width:100%">'}));var p=Object.assign({},this.default,a,{id:i}),f=$(d.table.template(p));return f.appendTo(c).on("init.dt",function(e){!function(e,a,t){var n=e.find(".dataTables_scrollBody")[0],r=e.find(".dataTables_scrollHead");if(t.searchingbycolumn&&r.on("keyup change","input.vmp-datatable-searchcolumn",function(e){var t=e.target,n=t.parentNode.cellIndex;a.column(n).search(t.value).draw()}),t.scrollY&&t.autoResizeScrollY&&!t.paging||l&&1500<n.clientHeight){var o=function(){ITA.util.set_elem_height_to_avoid_parents_scrollbars(n),a.columns.adjust()};$.unsubscribe("resizeend.datatable."+i),$.subscribe("resizeend.datatable."+i,o),$.publish("resizeend.datatable",o)}s.resolve()}(c,$(e.target).DataTable(),u)}).DataTable(u),[s,c]}},function(e,t){var b={graphs:{},str2date:function(e){var a=e.rows,n=e.cols,t=a[0]&&"c"in a[0],r=function(e,t){return 0===n[t].type.indexOf("date")&&"[object Date]"!==Object.prototype.toString.call(e)&&(e=new Date((e||"").replace(/-/g,"/").replace(/[TZ]/g," ").replace(".000",""))),e};return t?a.forEach(function(e){e.c.forEach(function(e,t){(e=e||{}).v=r(e.v,t)})}):a.forEach(function(e,n){var t=e;a[n]={c:[]},t.forEach(function(e,t){a[n].c.push({v:r(e,t)})})}),e},destroy:function(e,t){t in b.graphs&&b.graphs[t].clearChart&&(b.graphs[t].clearChart(),delete b.graphs[t]),e&&e.removeClass("google-visualization-atl container").removeAttr("style")},init:function(e,t,n,a,r,o,i,s){var l,c=document.getElementById(e),u="Bar"===i,d=n.height,p=c?$(c):$('<div id="'+e+'"></div>').appendTo(t.removeClass("panel-body")),f=p[0],m=function(){"auto"===d||"100%"===d?ITA.util.set_elem_height_to_avoid_parents_scrollbars(f):f.style.height=d+"px","calendar"in n&&(n.calendar.cellSize=Math.floor(16/865*p.width())),e in b.graphs&&b.graphs[e].draw(l,u?google.charts[i].convertOptions(n):n)},g=$.Deferred(),v={packages:a,callback:function(){l=new google.visualization[o](r),b.graphs[e]=u?new google.charts[i](p[0]):new google.visualization[i](p[0]),google.visualization.events.addListener(b.graphs[e],"error",function(e){if(e.id){var t=google.visualization.errors.getContainer(e.id);t&&google.visualization.errors.removeAll(t)}}),google.visualization.events.addListener(b.graphs[e],"ready",g.resolve),m(),"function"==typeof s&&s()}};b.destroy(p,e),p.css({width:"100%",height:n.height});var h=".googlechart."+i+"."+e;return $.unsubscribe("resizeend"+h),$.subscribe("resizeend"+h,m),"geochart"===a[0]&&(n.mapsApiKey?(v.mapsApiKey=n.mapsApiKey,v.key=n.mapsApiKey):console.error("en Google GeoChart: este servicio requiere una clave API: https://developers.google.com/maps/documentation/javascript/get-api-key")),google.load("visualization","1",v),g}};e.googlechart=b}(ITA.widget),ITA.widget.googlechart_pie={dependencies:{js:["https://www.google.com/jsapi","js/widgets/ita.items.googlechart.min.js"]},default:{hAxis:{title:"Year",titleTextStyle:{color:"#333"}},vAxis:{minValue:0},height:"350px"},destroy:function(e,t){ITA.widget.googlechart.destroy(e,t)},render:function(e){var t=e.id,n=e.json,a=e.$target;return[ITA.widget.googlechart.init(t,a,Object.assign({},this.default,n.value.options),["corechart"],n.value.data,"arrayToDataTable","PieChart"),null]}},ITA.widget.googlechart_treemap={dependencies:{js:["https://www.google.com/jsapi","js/widgets/ita.items.googlechart.min.js"]},default:{minColor:"#f00",midColor:"#ddd",maxColor:"#0d0",headerHeight:15,fontColor:"black",showScale:!0,height:"500px"},destroy:function(e,t){ITA.widget.googlechart.destroy(e,t)},render:function(e){var t=e.id,n=e.json,a=e.$target;return[ITA.widget.googlechart.init(t,a,Object.assign({},this.default,n.value.options),["treemap"],n.value.data,"arrayToDataTable","TreeMap",n.value.callback),null]}},ITA.widget.input={template:function(e){var t=ITA.util.tag,n=ITA.util.if,a=n(e.readonly," readonly "),r=n(e.label_hidden," sr-only "),o=n(e.disabled," disabled "),i=n(e.required," required "),s=e.label_width||4,l=e.name||"",c=e.id||l,u=e.value||"",d=n(e.help,'<span class="help-block">'+e.help+"</span>"),p=e.label||"",f=e.type||"text",m=e.layout||"",g=e.script||"",v=t("title",e.titlelabel),h=e.titleinput&&e.titleinput.length?' title="'+e.titleinput.split('"').join("&quot;")+'" ':"",b=t("placeholder",e.placeholder),y=t("form",e.idform),T=t("step",e.step),A=t("min",e.min),_=t("max",e.max),j=n(e.after,'<span class="input-group-addon">'+e.after+"</span>"),w=n(e.before,'<span class="input-group-addon">'+e.before+"</span>"),I=n(e.after_btn,'<span class="input-group-btn">'+e.after_btn+"</span>"),$=n(e.before_btn,'<span class="input-group-btn">'+e.before_btn+"</span>"),q=n(e.change,' onchange="ITA.functions.'+e.change+'()" '),x=n(e.size," form-group-"+e.size),k=n(e.size," form-control-"+e.size),O=(e.visibleif||[]).length?" hidden ":"",E='<label class="'+r+"col-sm-"+s+' control-label" for="'+c+'"'+v+">"+p+"</label>",S='<input type="'+f+'" class="form-control'+k+'" name="'+l+'" id="'+c+'" value="" '+(y+b+q+o+i+a+h+A+_+T)+' autocomplete="on">';p=n(p||e.help,'<label class="'+r+'" for="'+c+'"'+v+">"+p+"</label>"),"textarea"!==f&&"ace"!==f||(S='<textarea class="form-control'+k+'" name="'+l+'" id="'+c+'" '+(y+b+q+o+i+a+h)+">"+u+"</textarea>"),(w||j||I||$)&&(S='<div class="input-group">'+w+$+S+I+j+"</div>"),"static"===f&&(S='<p class="form-control-static"'+h+">"+u+"</p>"),"file"===f&&(S=0===q.length?'<input type="'+f+'" class="form-control'+k+'" value="" onchange="var cvs = new FileReader();cvs.readAsText(this.files[0],\'UTF-8\');cvs.onload=function(e){$(\'#'+c+"').val(e.target.result).trigger('change')};\" "+(y+b+o+i+a)+'><input type="hidden" name="'+l+'" id="'+c+'" >':'<span class="btn btn-default btn-file vmp-btn-action">'+p+'<input type="'+f+'" value="" onchange="var cvs = new FileReader();cvs.readAsText(this.files[0],\'UTF-8\');cvs.onload=function(e){$(\'#'+c+"').val(e.target.result).trigger('change')};\" "+(y+b+o+i+a)+'><input type="hidden" name="'+l+'" id="'+c+'"'+q+"></span>",p=E="");var C=[];switch(m){case"horizontal":C.push('<div class="form-horizontal"'+O+'><div class="form-group'+x+'">'+E+'<div class="col-sm-'+(12-s)+'">'+S+d+"</div></div></div>");break;case"inline":C.push('<div class="form-inline"'+O+'><div class="form-group'+x+'">'+p+S+d+"</div></div>");break;case"basic":case"full":C.push(""+p+S+d);break;default:C.push('<div class="form-group'+x+'"'+O+">"+p+S+d+"</div>")}return g&&C.push("<script>"+script+"<\/script>"),C.join("")},fn:{daterangepicker:{dependencies:{js:["vendor/bootstrap-daterangepicker/v2.1.30/moment.min.js","vendor/bootstrap-daterangepicker/v2.1.30/daterangepicker.min.js"],css:["vendor/bootstrap-daterangepicker/v2.1.30/daterangepicker.min.css"]},options:{showDropdowns:!0,linkedCalendars:!1,autoUpdateInput:!0,locale:{direction:"ltr",format:"DD/MM/YYYY",separator:" - ",applyLabel:"Aplicar",cancelLabel:"Cancelar",fromLabel:"Desde",toLabel:"Hasta",customRangeLabel:"Personalizar",daysOfWeek:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],firstDay:1}},init:function(e,t){var n,a={},r=this;return(n=$).when.apply(n,_toConsumableArray(ITA.load(r.dependencies))).then(function(){e.find("input[type=daterangepicker]").each(function(){if(this.value){var e=this.value.split(r.options.locale.separator);a.startDate=e[0],a.endDate=e[1]}}).daterangepicker(Object.assign({},r.options,ITA.util.get(t,"plugin.daterangepicker",a)))})}},datepicker:{dependencies:{js:["vendor/bootstrap-datepicker/v1.8.0/bootstrap-datepicker.min.js","vendor/bootstrap-datepicker/v1.8.0/bootstrap-datepicker.es.min.js","vendor/bootstrap-datepicker/v1.8.0/bootstrap-datepicker.en-GB.min.js"],css:["vendor/bootstrap-datepicker/v1.8.0/bootstrap-datepicker3.min.css"]},options:{language:"es",todayBtn:"linked",daysOfWeekHighlighted:[0,6],todayHighlight:!0,weekStart:1,format:"dd/mm/yyyy",assumeNearbyYear:!1,autoclose:!1,beforeShowDay:$.noop,beforeShowMonth:$.noop,beforeShowYear:$.noop,beforeShowDecade:$.noop,beforeShowCentury:$.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],datesDisabled:[],endDate:1/0,forceParse:!0,keepEmptyValues:!1,keyboardNavigation:!0,minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,dateCells:!1,title:"",templates:{leftArrow:"&laquo;",rightArrow:"&raquo;"}},init:function(e,t){var n,a=this;return(n=$).when.apply(n,_toConsumableArray(ITA.load(a.dependencies))).then(function(){e.find("input[type=datepicker]").datepicker(Object.assign({},a.options,ITA.util.get(t,"plugin.datepicker",{})))})}},ace:{dependencies:{js:["https://unpkg.com/ace-builds@1.3.3/src-min/ace.js","https://unpkg.com/ace-builds@1.3.3/src-min/ext-language_tools.js","https://unpkg.com/ace-builds@1.3.3/src-min/ext-modelist.js","https://unpkg.com/ace-builds@1.3.3/src-min/ext-themelist.js"],css:["<style>.vmp-ace-textarea{background-image: url('img/fa-edit.png');background-repeat: no-repeat;background-position: 92% 50%;background-size: contain;}.vmp-ace-editor.ace_editor{position: fixed;top:0;left:0;height: 100vh;width: 100vw;z-index: 1000;border: 24px solid rgba(0,0,0,.4);border-top-width: 48px;background-clip: padding-box;}.vmp-ace-editor.ace_editor::after {position: fixed;content: '';border-top: 24px solid #fff;top: 24px;left: 24px;right: 24px;}.vmp-ace-menu{position: absolute;z-index: 8;bottom: 2em;right:2em;}.vmp-ace-menu > *:not(:last-child){margin-right: 1em;}.vmp-ace-menu-top{position: absolute;z-index: 8;top: 2em;right: 2em;}</style>"]},options:{mode:"java",theme:"textmate",btn_close:{label:"Cerrar",classname:"btn btn-default"}},init:function(o,p){var e,i=this,s=function(e,r,o){return e.map(function(e){var t=o[e],n=t.name,a=t.caption;return'<option value="'+n+'"'+(r===n?" selected":"")+">"+a+"</option>"}).join("")},f=function(e,t){e.setTheme("ace/theme/"+t.theme),e.session.setMode("ace/mode/"+t.mode)};return(e=$).when.apply(e,_toConsumableArray(ITA.load(i.dependencies))).then(function(){var l=ITA.util,c=Object.assign({},i.options,l.get(p,"plugin.ace",{}));ace.require("ace/ext/language_tools");var u={enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1},e=ace.require("ace/ext/modelist").modesByName,t="java,javascript,html,css,json,hjson,matlab,python,r,xml".split(","),n=ace.require("ace/ext/themelist").themesByName,a=[],r=Object.keys(n).filter(function(e){var t=n[e].isDark;return t&&a.push(e),!t}),d='<div class="form-group"><label>mode: </label><select class="form-control vmp-ace-mode">'+s(t,c.mode,e)+'</select></div><div class="form-group"><label>theme: </label><select class="form-control vmp-ace-theme"><optgroup label="Temas claros">'+s(r,c.theme,n)+'</optgroup><optgroup label="Temas oscuros">'+s(a,c.theme,n)+"</optgroup></select></div>";o.find("textarea").addClass("vmp-ace-textarea").on("focus",function(e){var t=e.target,n=l.append(document.body,'<div class="vmp-ace-editor"></div>'),r=ace.edit(n);l.append(n,'<div class="form-inline vmp-ace-menu">'+d+"</div>").addEventListener("change",function(e){var t=e.target,n=t.matches("select.vmp-ace-mode"),a=t.matches("select.vmp-ace-theme");n?c.mode=t.value:a&&(c.theme=t.value),(n||a)&&f(r,c)}),r.setOptions(u),f(r,c),r.setValue(t.value),r.clearSelection(),r.focus(),r.on("change",function(){p.value=t.value=r.getValue()});var a=c.btn_close,o=a.label,i=a.classname,s=l.append(n,'<div class="form-inline vmp-ace-menu-top"></div>');l.append(s,'<button class="vmp-ace-btn-close '+i+'">'+o+"</button>").addEventListener("click",function(e){var t=e.target;r.destroy(),t.remove(),n.remove(),n=t=r=null}),$.publish("ace/init",{html:n,editor:r})})})}},events:function(e,t){(t||[]).forEach(function(n){e.on(n.event,function(e){if(n.action in ITA.functions){var t=0===e.type.indexOf("key");(t&&e.which===n.key||!t)&&ITA.functions[n.action]()}else console.warn('ERROR: en un INPUT (ita.items.input.js) hay definido un evento para una "action" que no existe en ITA.functions:'+n.action)})})}},beforeMount:function(e,o,t,n){var a=this.fn;"value"in t&&o.find("input").add(o.filter("input")).val(t.value),("textarea"===t.type||"ace"===t.type)&&"value"in t&&o.find("textarea").add(o.filter("textarea")).val(t.value),"static"!==t.type&&(o.on("input",function(e){return n.value.value=e.target.value,!1}),a.events(o,t.events),"ace"===t.type&&a.ace.init(o,n.value),"datepicker"===t.type&&a.datepicker.init(o,n.value),"daterangepicker"===t.type&&a.daterangepicker.init(o,n.value)),"visibleif"in t&&t.visibleif.forEach(function(e){var t=_slicedToArray(e,2),a=t[0],r=t[1];$('[name="'+a+'"]').on("change.visibleif",function(e){var t="radio"===e.target.type?$('input[name="'+a+'"]:checked'):$(e.target),n=r==t.val();o[0][n?"removeAttribute":"setAttribute"]("hidden",!0),n||o.find("select").val([]).trigger("change")}).trigger("change.visibleif")})},$_mounted:function(e,t,n){if("textarea"===t.type&&t.autogrow){var a=e.getElementsByTagName("textarea")[0],r=function(){a.style.height="0",a.style.height=a.scrollHeight+2+"px"};$(a).on("input.autogrow",r).trigger("input.autogrow"),$.subscribe("resizeend",r)}},render:ITA.util.render},ITA.widget.jstree={dependencies:{js:["vendor/jstree/v3.2.1-20160107/jstree.min.js","vendor/bootbox/v4.4.0/bootbox.min.js"],css:["vendor/jstree/jstree-bootstrap.min.css","<style>.jstree-hidden{display:none}.jstree-proton .jstree-search{font-style:normal;font-weight:normal;background-color:rgba(255,255,255,.6);}.jstree-rename-input{color: #333; /* si no hereda inherit el #ffff y no se ve */}</style>"]},destroy:function(e){if($(document).off("context_hide.jstree"),"jstree"in jQuery)return e.find(".jstree").jstree("destroy").promise()},fn:{nodesDragged:null,id_jstree_input:"input_jstree_",setvalue:function(e,t){document.getElementById(this.id_jstree_input+e).value=JSON.stringify({id:t.id,name:t.text,parent:t.parent})}},render:function(e){var o=e.id,t=(e.index,e.json),n=e.$target,i=this.fn,s=t.value,l=$("<div></div>"),a=void 0!==s.plugins&&-1<s.plugins.indexOf("search"),r=$.Deferred();return void 0===s.plugins&&(s.plugins=[]),s.plugins.push("contextmenu"),s.contextmenu={},s.contextmenu.items=function(e,t){return function(e){if(!Array.isArray(e)||0===e.length)return!1;var a={};return e.forEach(function(r){if("string"==typeof r&&("actions"in s?r in s.actions?r=s.actions[r]:console.error("No existe key '"+e+"' en o.json.value.actions['"+e+"']"):console.error("No existe objeto 'actions' en o.json.value.actions")),r.event){var t=null,n=0;l.on(r.event+".jstree","li:not(:has(ul))",r.action,"click"===r.event?function(e){return 1==++n?t=setTimeout(function(){ITA.functions[e.data](),n=0},300):(clearTimeout(t),n=0),!1}:function(e){return ITA.functions[e.data](),!1})}a[r.action]={item:r.item||"leaf",label:r.label,separator_after:"separator"in r&&r.separator,icon:r.icon,action:"type"in r&&"rename"===r.type?function(e){var t=$.jstree.reference(e.reference),n=t.get_node(e.reference),a=n.text;t.edit(n,n.text,function(e,t,n){t&&!n&&a!==e.text&&(i.setvalue(o,e),ITA.functions[r.action]())})}:"type"in r&&"newnode"===r.type?function(n){var e={size:"small",title:r.message||"Debes nombrarlo antes de crearlo!",value:"",callback:function(e){if(e){var t=$.jstree.reference(n.reference).get_node(n.reference);t.text=e,i.setvalue(o,t),ITA.functions[r.action]()}}};Array.isArray(r.values)&&0<r.values.length&&(e.inputType="select",e.inputOptions=r.values.map(function(e){return{text:e[1],value:e[0]}})),bootbox.prompt(e)}:function(e){ITA.functions[r.action]()}}}),a}(e.original.actions)},function e(t){for(var n in t)"actions"===n&&Array.isArray(t[n])&&0<t[n].length?("a_attr"in t==0&&(t.a_attr={}),t.a_attr.class=t[n].map(function(e){return"vmp-action-"+(e.action||e)}).join(" ")):"object"===_typeof(t[n])&&e(t[n])}(s),$.jstree.defaults.state.key="jstree"+o,$.jstree.defaults.search.show_only_matches=!0,$.jstree.defaults.search.show_only_matches_children=!0,$.jstree.defaults.dnd.is_draggable=function(e){return i.nodesDragged=e,!0},$(document).off("context_hide.jstree").off("dnd_start.vakata").on("dnd_start.vakata",function(e,t,n){var a=t.data,r=$(a.obj.context);r.jstree("deselect_all"),r.jstree("select_node",i.nodesDragged[0])}),l.on("move_node.jstree",function(){i.setvalue(o,i.nodesDragged[0])}).on("ready.jstree",function(){$('<input id="'+i.id_jstree_input+o+'" name="'+o+'" type="text" class="jstree-input-value form-control debug-off-hidden hidden" readonly></input>').prependTo(n),a&&$('<div class="input-group"><input type="text" class="form-control" placeholder="Filtrar por..."><span class="input-group-addon"><span class="glyphicon glyphicon-search"></span></span></div>').prependTo(n).find("input").on("keyup",ITA.util.debounce(function(e){l.jstree(!0).search(e.target.value)},250)),r.resolve()}).on("select_node.jstree",function(e,t){i.setvalue(o,t.node),function(e){if(!Array.isArray(e)||0===e.length)return;e.forEach(function(e){ITA.util.empty(e.target)}),ITA.renderContent(e)}(t.node.original.content)}).appendTo(n).jstree(s),[r,l]}},ITA.widget.select={default:{id:null,name:"",idform:"",actions:[],children:{},value:"",label:"",titlelabel:"",titleinput:"",multiple:!1,rows:0,before:"",after:"",help:"",layout:"vertical",label_width:4,label_hidden:!1,disabled:!1,required:!1,readonly:!1,type:"",script:"",change:"",size:"",visibleif:[]},template:function(e){var a=e.id,r=e.name,t=e.label_width,n=e.value,o=e.label,i=e.layout,s=e.type,l=e.script,c=e.children,u=e.titlelabel,d=e.titleinput,p=e.readonly,f=e.label_hidden,m=e.disabled,g=e.required,v=e.multiple,h=e.idform,b=e.rows,y=e.help,T=e.after,A=e.before,_=e.change,j=e.size,w=e.visibleif;a=a||r;var I=ITA.util.tag,$=ITA.util.if,q=function(n,a){return Array.isArray(n)?n.map(function(e,t){return a(e[0],e[1],t)}).join(""):Object.keys(n).map(function(e,t){return a(e,n[e],t)}).join("")},x=$(p," readonly "),k=$(f," sr-only "),O=$(m," disabled "),E=$(g," required "),S=$(v," multiple "),C=$(y,'<span class="help-block">'+y+"</span>"),R=$(T,'<span class="input-group-addon">'+T+"</span>"),D=$(A,'<span class="input-group-addon">'+A+"</span>"),z=$(_,' onchange="ITA.functions.'+_+'()" '),N=$(j," form-group-"+j+" "),L=$(j," form-control-"+j+" "),M=w.length?" hidden ":"",P=I("title",u),F=I("title",d.split('"').join("&quot;")),H=I("form",h),J=I("size",b),V='<label class="'+k+"col-sm-"+t+' control-label" for="'+a+'"'+P+">"+o+"</label>",U=void 0,B='<label class="bmd-label-static'+k+'" for="'+a+'"'+P+">"+o+"</label>",Y=function(t,e){return n==t||Array.isArray(n)&&n.some(function(e){return e==t})?" "+e+" ":""},W=q(c,function(e,t){return'<option value="'+e+'"'+Y(e,"selected")+">"+t+"</option>"});if(U='<select id="'+a+'" name="'+r+'" class="form-control'+L+'" data-param="'+r+'" title="Selecciona '+r+'" '+H+" "+J+" "+z+" "+O+" "+x+" "+E+" "+S+" "+F+">"+W+"</select>",(D||R)&&(U='<div class="input-group">'+D+U+R+"</div>"),"static"===s&&(U='<p class="form-control-static"'+F+">"+c[n]+"</p>"),"radio"===s||"checkbox"===s){var G=function(e,t,n){return'<input type="'+s+'" name="'+r+'" id="'+a+n+'" value="'+e+'" '+H+" "+O+" "+Y(e,"checked")+"> "+t};U=q(c,function(e,t,n){return"inline"===i?'<label class="'+s+'-inline">'+G(e,t,n)+"</label>":'<div class="'+s+O+'"><label>'+G(e,t,n)+"</label></div>"})}var X=[];switch(i){case"horizontal":X.push('<div vmp="'+a+'" class="form-horizontal"'+M+'><div class="form-group'+N+'">'+V+'<div class="col-sm-'+(12-t)+'">'+U+C+"</div></div></div>");break;case"inline":X.push('<div vmp="'+a+'" class="form-inline"'+M+'><div class="form-group'+N+'">'+B+U+C+"</div></div>");break;case"basic":X.push(""+B+U+C);break;case"full":X.push('<div vmp="'+a+'">'+B+U+C+"</div>");break;default:X.push('<div vmp="'+a+'" class="form-group'+N+'"'+M+">"+B+U+C+"</div>")}return l&&X.push("<script>"+l+"<\/script>"),X.join("")},beforeMount:function(t,o,n,i){var a=n.name,r=n.type,s=(n.children,n.actions),l=n.visibleif;if("static"!==r){var c=function(){return $.publish("change."+a,[i.value])};o.on("change","checkbox"===r?function(t){var n=t.target,a=t.currentTarget;i.value.value=Array.from(a.querySelectorAll('[name="'+n.name+'"]')).filter(function(e){return e.checked}).map(function(e){return e.value});var r=ITA.functions||{};return s.forEach(function(t){t in r?r[t]():console.warn('ERROR: en un SELECT (ita.items.select.js) hay definido un evento para un "mode"="action" que NO EXISTE en ITA.functions["'+e.action+'"]')}),c(),!1}:function(e){var t=e.target;return i.value.value=t.multiple?function(e){for(var t=0,n=[],a=e.options;t<a.length;t++)a[t].selected&&n.push(a[t].value);return n}(t):t.value,c(),!1}).on("vmp.update",function(e){console.warn(this)})}l.forEach(function(e){var t=_slicedToArray(e,2),a=t[0],r=t[1];$('[name="'+a+'"]').on("change.visibleif",function(e){var t="radio"===e.target.type?$('input[name="'+a+'"]:checked'):$(e.target),n=r==t.val();o[0][n?"removeAttribute":"setAttribute"]("hidden",!0),n||o.find("select").val([]).trigger("change"),$.publish("change.visibleif."+a,[e.target])}).trigger("change.visibleif")})},render:ITA.util.render},ITA.widget.select2={dependencies:{css:["vendor/select2/v4.0.6-rc.1/select2.min.css","vendor/select2/v4.0.6-rc.1/select2-bootstrap.min.css"],js:["js/widgets/ita.items.select.min.js","vendor/select2/v4.0.6-rc.1/select2.full.min.js","vendor/select2/v4.0.6-rc.1/i18n/es.js","js/widgets/ita.items.speech_recognition.min.js"]},default:{id:null,name:"",idform:"",actions:[],children:{},value:"",label:"",titlelabel:"",titleinput:"",multiple:!1,rows:0,before:"",after:"",help:"",layout:"vertical",label_width:4,label_hidden:!1,disabled:!1,required:!1,readonly:!1,type:"",script:"",change:"",size:"",placeholder:"",open_empty:!1,tags:!0,visibleif:[]},beforeMount:function(e,o,t,a){var n=t.open_empty,r=t.placeholder,i=t.tags,s=t.actions,l=t.multiple,c=t.visibleif,u=function(t){$(t.target).append(t.params.data.element).trigger("change"),a.value.value=$(t.target).val();var n=ITA.functions||{};s.forEach(function(e){e in n?n[act]():console.warn('ERROR: en un SELECT2 (ita.items.select2.js) hay definido un evento para un "mode"="action" que NO EXISTE en ITA.functions["'+t.action+'"]')})};o.on("select2:select",u).on("select2:unselect",u),l||o.on("select2:open",function(e){$(".select2-search__field").val(e.target.value)}),c.forEach(function(e){var t=_slicedToArray(e,2),a=t[0],r=t[1];$("[name="+a+"]").on("change.visibleif",function(e){var t="radio"===e.target.type?$("input[name="+a+"]:checked"):$(e.target),n=r==t.val();o[0][n?"removeAttribute":"setAttribute"]("hidden",!0),n||o.find("select").val([]).trigger("change")}).trigger("change.visibleif")}),o.find("select").add(o.filter("select")).css("width","100%").select2({tags:i,placeholder:r,allowClear:!0}),o.find(".select2-search__field").addClass("form-control").css("height","auto"),n&&o.on("select2:open",function(){var t=$("input.select2-search__field");setTimeout(function(){t.val("")},0),ITA.widget.speech_recognition&&ITA.util.speech_recognition(t,{onstart:function(){t.val("")},onresult:function(e){t.val(e)},onend:function(e){0<e.length&&(t.trigger("input"),$(".select2-results__option--highlighted").trigger("mouseup"))}})})},render:function(e){return ITA.widget.select||console.error("ERROR: falta añadir dependencia: ita.select.js"),this.template=ITA.widget.select.template,ITA.util.render.call(this,e)}},ITA.widget.solr_dates_range={dependencies:{js:["vendor/bootstrap-daterangepicker/v2.1.30/moment.min.js","vendor/bootstrap-daterangepicker/v2.1.30/daterangepicker.min.js"],css:["vendor/bootstrap-daterangepicker/v2.1.30/daterangepicker.min.css"]},fn:{fn:function(e){return ITA.widget.solr_query.fn[e]},"dd/mm/yyyy2yyyy-mm-dd":function(e){return e.split("/").reverse().join("-")},"dd/mm/yyyy2iso":function(e){return new Date(FN["dd/mm/yyyy2yyyy-mm-dd"](e)).toJSON()}},defaults:{showDropdowns:!0,linkedCalendars:!1,autoUpdateInput:!1,autoApply:!0,locale:{direction:"ltr",format:"DD/MM/YYYY",separator:" - ",applyLabel:"Aplicar",cancelLabel:"Borrar",fromLabel:"Desde",toLabel:"Hasta",customRangeLabel:"Personalizar",daysOfWeek:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],firstDay:1}},render:function(e){var c,u,t=e.id,s=e.json,n=e.$target,d=this.fn,a=this.defaults,r=s.value.classname||"",o=$('<div class="solr_dates_range '+r+'"></div>'),p=s.value.field,i={mode:"input",id:t,value:{name:p,label:p,after:"<i class='fa fa-calendar'></i>",layout:"vertical",titlelabel:p,titleinput:p,size:"sm"}},l=ITA.renderComponent(null,i,o).then(function(e){var t=e[0],s="DD/MM/YYYY",l="YYYY-MM-DDTHH:mm:ss.SSS",n=function(){var e=document.querySelector('button[data-fqapplied^="'+p+'"] i');e&&e.click()};return u=t.getElementsByTagName("label")[0],c=$(t.getElementsByTagName("input")[0]).daterangepicker(a).on("apply.daterangepicker",function(e,t){var n,a,r=e.target,o=t.startDate,i=t.endDate;r.value=(n=i,o.format(s)+" - "+n.format(s)),d.fn("set_fq_and_query")(p+":"+(a=i,"["+o.format(l)+"Z TO "+a.format(l)+"Z]")," "+u.textContent+": "+r.value,p+":")}).on("cancel.daterangepicker",function(e){e.target.value="",n()}).on("change",function(e){""===e.target.value&&n()}),t}),f=/\[(.+) TO (.+)\]/;p||console.error("ERROR: falta definir (.hjson) campo 'value.field' en el objeto: ",s);var m=".solr_dates_range."+t;return $.unsubscribe("solr/load"+m),$.subscribe("solr/load"+m,function(e,t){var n,a,r,o,i=(n=p,a=t.responseHeader.params.fq,r=void 0===a?[]:a,o=n+":",ITA.util.castArray(r).filter(function(e){return 0===e.indexOf(o)}).map(function(e){return e.substr(o.length)}));return i.length&&(i=i[0].match(f).slice(1)),l.then(function(e){var t;if(u.innerHTML=(t=p,d.fn("label")(t,s)),2===i.length){var n=c.data("daterangepicker");n.setStartDate(moment(i[0]).format("DD/MM/YYYY")),n.setEndDate(moment(i[1].split("T")[0]).format("DD/MM/YYYY"))}else c[0].value="";return e})}),o.appendTo(n),[ITA.$_RESOLVED,o]}},ITA.widget.solr_documents_tmpl={fn:{filterfy:function(e,t,n,a){return" data-fq='"+e+':"'+t+'"\' title="filtrar por '+e+'" '+(n||a?"data-fq-alias='"+(n||e)+':"'+(a||t)+"\"'":"")},linkify:function(){var n=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,a=/(^|[^\/])(www\.[\S]+(\b|$))/gim,r=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,o=/@(\w+)/g,i=/#(\w+)/g;return function(e,t){return e.replace(n,'<a href="$1" target="_blank" rel="noopener">$1</a>').replace(a,'$1<a href="http://$2" target="_blank" rel="noopener">$2</a>').replace(r,'<a href="mailto:$1">$1</a>').replace(o,'<a href="//www.twitter.com/$1" target="_blank" rel="noopener" class="tweet-user">@$1</a>').replace(i,'<a target="_blank" rel="noopener" href="//twitter.com/search?src=hash&q=%23$1" class="tweet-hashtag">#$1</a>')}}(),createFacetUpdate:function(c,u){var d={mode:"notify",value:{id:"notify-update",type:"warning",title:"Cambiar valor de ",body:'<div id="notify-body"></div><button id="notify-cancel" class="btn btn-default pull-right js-update-facet-cancel">Cancelar</button> <button id="notify-submit" class="btn btn-primary pull-right js-update-facet-submit">Enviar nuevo valor</button>',delay:"0",horizontal:"center",vertical:"top",modal:!0,modal_bgcolor:"rgba(0,0,0,.7)"}},p=function(){$("#notify-update").find(".close").trigger("click")};c.off(".facetUpdate").on("click.facetUpdate","[data-field]",function(e){var t=$(this).data(),n=$(this).parent().data(),a=t.field,r=t.value,o=n.idvalue,i=n.idname,s=$.ajax({dataType:"json",url:ITA.solr.solrUrl+"select?json.wrf=?&rows=0&wt=json&facet=true&facet.field="+a+"&json.nl=map&f."+a+".facet.sort=index"}),l={mode:"select",value:{name:"notify-select",label:a,type:"radio",value:r}};$.when(s,ITA.renderComponent(null,d,c)).then(function(e){var n=u[a]||{};return l.value.children=ITA.util.map(ITA.util.get(e[0],"facet_counts.facet_fields."+a,{}),function(e,t){return["number"==typeof r?1*t:t,t in n?n[t]:t]}),ITA.renderComponent(null,l,$("#notify-body"))}).then(function(){$("#notify-cancel").one("click",p),$("#notify-submit").one("click",function(){var e={};e[i]=o,e[a]={set:l.value.value},$.publish("solr/update",e),p()})})})}},render:function(e){var t=e.id,i=e.json,s=e.$target,l=_.template(i.value.template),c=this.fn,n=function(e,t){var n=t.response.docs||[],a=t.responseHeader.params.fl||"",r=(a?a.split(","):Object.keys(n[0]),{mode:"value",id:"solr-documents",value:""}),o=function(e){return ITA.util.get(i.value,"label."+e+"."+ITA.solr.lang,e)};r.value=n.reduce(function(e,t){return e+l({o:t,linkify:c.linkify,filterfy:c.filterfy,translate:o})},""),ITA.util.empty(s[0]),$.when(ITA.renderComponent(null,r,s)).then(function(){c.createFacetUpdate(s,ITA.util.get(i,"value.update.label",{})),$.publish("solr/rendered",e),$('[data-toggle="popover"]').popover()})};s.on("click.document-remove",".js-vmp-solr-document-remove",function(e){var t=$(e.target).parent(),n=t.data("idname"),a=t.data("idvalue");if(n&&n.length&&a&&a.length){if(confirm("¿ Seguro que quiere borrar este documento ? (el borrado es irreversible)")){var r=[],o={};o[n]=a,r.push(o),console.warn(r),$.publish("solr/delete",r)}}else console.error("no está definido idname y/o idvalue: ",n,a)});var a=".solr_documents_tmpl."+t;return $.unsubscribe("solr/load"+a),$.subscribe("solr/load"+a,n),$.unsubscribe("solr/load/docs"+a),$.subscribe("solr/load/docs"+a,n),[ITA.$_RESOLVED,null]}},ITA.widget.solr_filteredby={render:function(e){var o,t=e.id,n=e.json,a=e.$target,r=n.value.classname||"",i=$('<div class="solr_filteredby '+r+'"></div>'),s=function(e){return o.label(e,n)},l=function(e,t){var n=0<e.indexOf(':"')?e.split(':"'):e.split(":["),a=s(n[0]),r=n[1]&&n[1].length&&0<n[1].indexOf("#")?n[1].split("#")[1]:n[1],o=r?": "+r:"";return'<button type="button" class="btn btn-xs'+(t?" "+t:"")+'" data-fqapplied="'+escape(e)+'" title="'+e.replace(/\"/g,"&quot;")+'"><i class="'+ITA.solr.icon.remove+'"></i>&nbsp;'+(ITA.solr.alias.fq[e]||a+o)+"</button>"};i.on("click","button",function(){var e=ITA.solr.query;if(this.classList.contains("remove-all-filters"))e.fq=[],ITA.solr.alias.fq={},o.reset_q();else{var t=unescape($(this).data("fqapplied"));o.remove_q_fq(t,t===e.q)}return $.publish("solr/query"),!1});var c=".solr_filteredby."+t;return $.unsubscribe("solr/load"+c),$.subscribe("solr/load"+c,function(e,t){o=ITA.widget.solr_query.fn;var n,a=ITA.solr.query.fq,r=[l(s("remove_all_filters"),"remove-all-filters btn-primary")];a.forEach(function(e){r.push(l(e,"btn-default"))}),r.length<=2&&r.shift(),i.html((n=r.join(""),"<h4>"+s("filtered_by")+":</h4>"+(n.length<=1?"<h6>"+s("viewing_all_documents")+"</h6>":"")+n))}),i.appendTo(a),[ITA.$_RESOLVED,i]}},ITA.widget.solr_graphs={fn:{fn:function(e){return ITA.widget.solr_query.fn[e]},$_query:function(e,t,n){var a=e.json,r=(e.$target,t.query),o=(t.layerLoading,t.solrUrl),i=r?Object.assign({},r,a.value.query):a.value.query;return $.ajax({dataType:"json",xhrFields:{withCredentials:!0},url:o+(n||"select")+"?"+$.param(i,!0)+"&json.wrf=?"})},$_component:function(e,t,n){var a=n.$target,r=n.id;return"id"in t||(t.id=r+t.mode),a.children("."+e).remove(),ITA.renderComponent(null,t,$('<div class="'+e+'"></div>').appendTo(a))},renderTreemap:function(t,e){var a=this,n=ITA.util.get(e,"response.facet_counts.facet_fields",[]),r=t.json.value.field,o=n[r],i=function(e){return a.fn("label")(e,t.json)},s=Object.values(o),l=s[s.length-1],c=s[0],u=function(e){return 0<e.indexOf("#")?e.split("#")[1].split("_").join(" "):e},d=t.json.value.skip?function(e){return-1===t.json.value.skip.indexOf(u(e))}:function(e){return!0},p=t.json.value.limit?function(e){return e.length<=t.json.value.limit}:function(e){return!0},f=[],m={mode:"googlechart_treemap",value:{data:[[r,"Parent","Number of ocurrencies (size)","collectorID"],[i(r),null,0,0]].concat(Object.keys(o).reduce(function(e,t){return d(t)&&p(e)&&(e.push([i(u(t))+" ("+o[t]+")",i(r),o[t],(o[t]-l)/(c-l)||0]),f.push(t)),e},[])),options:Object.assign({fontColor:"black",generateTooltip:function(e){return'<h3 style="background:#fd9; padding:10px; border-style:solid">'+m.value.data[e+1][0]+"</h3>"},highlightOnMouseOver:!0,minColor:"rgb(184, 143, 163)",midColor:"rgb(143, 163, 184)",maxColor:"rgb(163, 184, 143)",headerHeight:25,showScale:!0,height:500,useWeightedAverageForAggregation:!0},ITA.util.get(t,"json.value.jsongraph.value.options",{}))}};return a.$_component("vmp-mode-googlechart_treemap",m,t).then(function(){var n=ITA.widget.googlechart.graphs[m.id];google.visualization.events.addListener(n,"select",function(e){var t=f[n.getSelection()[0].row-1];a.fn("set_fq_and_query")(r+':"'+t+'"',i(r)+": "+i(u(t)))})})},renderWordcloud:function(e,t){var n=this,a=ITA.util.get(t,"response.facet_counts.facet_fields",[]),r=e.json.value.field,o=a[r],i=e.json.value.noqueryfilter,s=e.json.value.stopwords,l=e.json.value.jsongraph;return s&&(o=ITA.util.pickBy(o,function(e,t){return 2<t.length&&!(t in s)})),l.value.data=ITA.util.toPairs(o),n.$_component("vmp-mode-wordcloud2",l,e).then(function(e){if(i)return ITA.$_RESOLVED;$.unsubscribe("wordcloud2/click."+l.id),$.subscribe("wordcloud2/click."+l.id,function(e,t){n.fn("set_fq_and_query")(r+':"'+t.item.word+'"',r+": "+t.item.word)})})},renderAnnotation:function(t,e){var a=t.json.value.fieldNumber,r=t.json.value.fieldDate,n=t.json.value.label.number[e.lang],o=t.json.value.label.date[e.lang],i={mode:"googlechart_annotation",value:{data:{cols:[{type:"date",id:r,label:o},{type:"number",id:a,label:n}]},options:Object.assign({height:"300px"},ITA.util.get(t,"json.value.jsongraph.value.options"))}},s=this;return s.$_query(t,e).done(function(e){var n={};return e.response.docs.forEach(function(e){var t=e[r].slice(0,10);t in n||(n[t]=[0,0]),n[t]=[e[a]+n[t][0],n[t][1]+1]}),i.value.data.rows=ITA.util.map(n,function(e,t){return{c:[{v:t},{v:e[0]/e[1]}]}}),s.$_component("vmp-mode-googlechart_annotation",i,t)})},renderC3:function(l,c){var u=this,d=_.clone(l.json.value.jsongraph),e=function(e){var o=l.json.value["facet.pivot"]||e.responseHeader.params["facet.pivot"],i=e.facet_counts.facet_pivot[o],t=d.value.data,a=t.json=[],n=t.keys={},r=t.groups,s={};return t.onclick=function(e,t){var n=c.query.fq,a=[o.split(",")[1]+':"'+e.id+'"',o.split(",")[0]+':"'+i[e.x].value+'"'],r=c.query.fq=_.union(n,a);n.length!==r.length&&$.publish("solr/query")},_.sortBy(i,"value").forEach(function(e,t){var n={};n[e.field]=new Date(e.value).toLocaleString().split(":00:00").join("h"),e.pivot.forEach(function(e){e.value in s||(s[e.value]=1),n[e.value]=r?e.count:(_.reduce(e.pivot,function(e,t){return e+t.value*t.count},0)/e.count).toFixed(3)}),a.push(n)}),n.x=i[0].field,n.value=Object.keys(s).sort(),r&&(t.groups=[],t.groups.push(n.value)),d.id=l.id+d.mode,u.$_component("vmp-mode-c3",d,l)};return l.json.value.query?u.$_query(l,c).done(e):e(c.response)},renderC3_avg:function(c,u){var d=this,p=_.clone(c.json.value.jsongraph),e=function(e){var o=c.json.value["facet.pivot"]||e.responseHeader.params["facet.pivot"],i=_.sortBy(e.facet_counts.facet_pivot[o],"value"),t=p.value.data,r=t.json=[],n=t.keys={},a=t.groups,s={},l={};return t.onclick=function(e,t){var n=u.query.fq,a=[o.split(",")[1]+':"'+l[e.id]+'"',o.split(",")[0]+':"'+i[e.x].value+'"'],r=u.query.fq=_.union(n,a);n.length!==r.length&&$.publish("solr/query")},i.forEach(function(n,e){var a={};a[n.field]=n.value+" ("+n.count+")",n.pivot.forEach(function(e){var t=(""+e.value).split(".").join("_");l[t]=e.value,t in s||(s[t]=1),a[t]=(100*e.count/n.count).toFixed(1)}),r.push(a)}),n.x=i[0].field,n.value=Object.keys(s).sort(),a&&(t.groups=[],t.groups.push(n.value)),p.id=c.id+p.mode,d.$_component("vmp-mode-c3",p,c)};return c.json.value.query?d.$_query(c,u).done(e):e(u.response)},renderDatatable:function(i,s){var l=this;return l.$_query(i,s).done(function(e){var r={},t=e.response.docs||[],n=e.responseHeader.params.fl||"",o=n?n.split(","):Object.keys(t[0]),a={mode:"datatable",id:i.id+"datatable",value:{thead:[],tbody:[],options:Object.assign({scrollY:350,autoResizeScrollY:!0,processing:!0,stateSave:!0,paging:!1,info:!1},i.json.value.options)}};return a.value.thead.push(o.map(function(e){return ITA.util.get(i.json.value,"label."+e+"."+s.lang,e)})),a.value.tbody=t.map(function(a){return o.map(function(e){return[' class="docs-'+e+'" data-field="'+e+'" data-value="'+a[e]+'"',(t=e,n=a[e],void 0===r[t]&&(r[t]=ITA.util.get(i.json,"value.format."+t,!1),r[t]&&(r[t]=_.template(r[t]))),r[t]?r[t]({label:ITA.util.get(i.json.value,"label."+t+"."+s.lang,t),value:n}):ITA.util.escapeHTML(n))];var t,n})}),l.$_component("vmp-mode-datatable",a,i)})},renderMap:function(t,e){var n=this,a=t.json.value.fieldLongitude,r=t.json.value.fieldLatitude,o=t.json.value.fieldLabel,i=t.json.value.tmplIcon,s=t.json.value.jsongraph;return o&&(o=_.template(o)),i&&(i=_.template(i)),n.$_query(t,e).done(function(e){return s.value.markers=e.response.docs.map(function(e){var t={coord:[e[r],e[a]]};return o&&(t.label=o({o:e})),i&&(t.icon=JSON.parse(i({o:e}))),t}),n.$_component("vmp-mode-leaflet",s,t)})},renderClustering:function(t,a){var r=this,o=t.json.value.query.fl,i=t.json.value.jsongraph,s=t.json.value.noqueryfilter,l=function(e){return r.fn("label")(e,t.json)};return r.$_query(t,a,"clustering").done(function(n){return i.value.data=[["cluster","num"]],n.clusters.forEach(function(e){i.value.data.push([e.labels.map(function(e){return l(e)}).join(",")+" ("+e.docs.length+")",e.docs.length])}),r.$_component("vmp-mode-googlechart_pie",i,t).then(function(e){if(s)return ITA.$_RESOLVED;var t=ITA.widget.googlechart.graphs[i.id];google.visualization.events.addListener(t,"select",function(){a.query.fq;var e=t.getSelection()[0].row;void 0!==e&&r.fn("set_fq_and_query")(o+":("+n.clusters[e].docs.map(function(e){return'"'+e+'"'}).join(" OR ")+")",l(o)+':"'+l(n.clusters[e].labels[0])+'"',o)})})})},renderCytoscape:function(t,r){var n=this;return $.getJSON(t.json.value.urljson).then(function(e){t.json.value.style[0].style["background-color"]=function(e){return"rgb("+e.data("r")+","+e.data("g")+","+e.data("b")+")"},e.elements.edges.forEach(function(e){e.selectable=!1});var a={id:"cy"+e.data.id,mode:"cytoscape_viewer",value:{height:"auto",name:e.data.name,elements:e.elements,style:t.json.value.style}};return n.$_component("vmp-mode-cytoscape",a,t).then(function(){var t=$("#"+a.id).cytoscape("get");t.on("select","node",function(e){t.elements().addClass("faded"),e.cyTarget.removeClass("faded").neighborhood().removeClass("faded").addClass("selected")}).on("unselect","node",function(e){t.elements().removeClass("faded"),e.cyTarget.neighborhood().removeClass("selected")}),t.nodes().forEach(function(e){var t,n;e.qtip({content:{text:(t=e,n=t.data("createdat")?'<small style="float:right">'+new Date(t.data("createdat").replace(/CET/,"+0100").replace(/CEST/,"+0200")).toLocaleString()+"</small>":"","<strong>"+t.data("name")+'</strong><img src="'+t.data("urlminiimage")+'" style="float:right"><br/><small>'+t.data("followerscount")+" Followers</small><p>"+t.data("description")+'</p><small style="float:right">'+t.data("location")+"</small><br/>"+n+""),title:e.data("name")},style:{classes:"qtip-bootstrap"},position:{my:"bottom center",at:"top center",target:e}})});var n;ITA.util.castArray(ITA.util.get(r,"response.responseHeader.params.fq","")).forEach(function(e){e&&0===e.indexOf("core:")&&(n=e.split("core:")[1])}),n&&t.remove("node[type!="+n+"]")})})},renderSelectQuery:function(e,t){var n=e.json.value.jsongraph;return document.getElementById(n.value.name)?ITA.$_RESOLVED:ITA.renderComponent(null,n,e.$target).then(function(e){e.find("select").on("change",function(){FN.fn("set_fq_and_query")(this.value,this.value,this.value.split(":")[0]+":")})})},renderJSON:function(e,t){var r=e.json.value,o="endpointjson"in r?ITA.util.getEndpoint(ITA.project,r.endpointjson):{method:r.method||"POST",url:r.urljson,contentType:"application/x-www-form-urlencoded",xhrFields:{withCredentials:!0}},i=function(e){return console.warn("EXITO, ",e),ITA.renderContent(e)};return $.ajax(o).done(i).fail(function(e,t,n){var a;console.error("ERROR en CORS, ",t,n),(a=o).url="asp/ita.proxy.asp?"+r.endpointjson,console.log(a.url),$.ajax(a).done(i).fail(function(e,t,n){console.error("Se acabo, ",t,n)})})}},render:function(e){var a=e.id,r=e.index,o=e.json,i=e.$target,s={datatable:"renderDatatable",wordcloud:"renderWordcloud",annotation:"renderAnnotation",map:"renderMap",clustering:"renderClustering",c3:"renderC3",c3_avg:"renderC3_avg",cytoscape:"renderCytoscape",select_query:"renderSelectQuery",treemap:"renderTreemap",json:"renderJSON"},l=this.fn,t=function(e,t){ITA.util.empty(i[0]);var n=s[o.value.graph];void 0!==(void 0===n?"undefined":_typeof(n))?l[n]({id:a,index:r,json:o,$target:i},ITA.solr):console.error('solr_graphs: ERROR: no existe función para "'+o.value.graph+'"')},n=".solr_graphs."+o.value.graph;return $.unsubscribe("solr/load"+n),$.subscribe("solr/load"+n,t),"treemap"===o.value.graph&&($.unsubscribe("resizeend"+n),$.subscribe("resizeend"+n,t)),[ITA.$_RESOLVED,null]}},ITA.widget.solr_pagination={destroy:function(e,t){},default:{size:"",previous:'<i class="fa fa-angle-left"></i> Previous',next:'<i class="fa fa-angle-right"></i> Next',first:'<i class="fa fa-angle-double-left"></i> First',last:'<i class="fa fa-angle-double-right"></i> Last',rows:0,rowsShown:0,start:0,numtotal:1,numbtns:0,rowsExpected:0},template:function(e){var t=e.size,n=e.previous,a=e.next,r=e.first,o=e.last,i=e.rows,s=e.rowsShown,l=e.start,c=e.numtotal,u=e.numbtns,d=(e.rowsExpected,l+1),p=c-c%i,f=l===p;return'<ul class="pagination '+t+'">'+(0===l?"":'<li><a data-page="0" aria-label="First"><span aria-hidden="true">'+r+'</span></a></li><li><a data-page="'+(l-i)+'" aria-label="Previous"><span aria-hidden="true">'+n+"</span></a></li>")+(u?Array(u).join(0).split(0).map(function(e,t){return l+i*(t+1)<c?('<li><a data-page="'+(l+i*t)+'">'+(t+1)+"</a></li>").trim():""}).join(""):"")+(f?"":'<li><a data-page="'+(l+i)+'" aria-label="Next"><span aria-hidden="true">'+a+'</span></a></li><li><a data-page="'+p+'" aria-label="Last"><span aria-hidden="true">'+o+"</span></a></li>")+"</ul><p>"+d+" a "+(d+s-1)+" ("+s+') de <span class="label label-default">'+c+"</span></p>"},render:function(e){var t=e.id,n=e.json,a=e.$target,r=this,o=$.Deferred(),i=Object.assign({},this.default,n.value),s=function(e,t){l[0].innerHTML=r.template(Object.assign(i,{numtotal:t.response.numFound,start:t.response.start,rows:parseInt(t.responseHeader.params.rows),rowsShown:t.response.docs.length})),o.resolve()},l=$("<nav></nav>");a.on("click",".pagination a",function(){ITA.solr.query.start=this.dataset.page,$.publish("solr/query/docs")});var c=".solr_pagination."+t;return $.unsubscribe("solr/load"+c),$.subscribe("solr/load"+c,s),$.unsubscribe("solr/load/docs"+c),$.subscribe("solr/load/docs"+c,s),l.appendTo(a),[ITA.$_RESOLVED,l]}},ITA.widget.solr_query={fn:{reset_q:function(){var e=ITA.solr.query;"q0"in e&&(e.q=e.q0)},remove_q_fq:function(t,e){var n=ITA.solr.query;e&&this.reset_q(),delete ITA.solr.alias.fq[t],n.fq=n.fq.filter(function(e){return e!==t})},set_q_fq_and_query:function(e,t,n,a){var r=ITA.solr.query;"*:*"===r.q0?""===a.value?(this.remove_q_fq(n,!0),$.publish("solr/query")):(r.q=e,this.set_fq_and_query(e,t,n)):console.warn('OJO!!! llamo a function set_q_fq_and_query, pero q0="'+r.q0+'", y no hago nada')},set_fq_and_query:function(e,t,n){var a=ITA.solr.query.fq,r=ITA.solr.alias.fq;a.includes(e)||(void 0!==n&&(a=ITA.solr.query.fq=a.filter(function(e){var t=e.startsWith(n);return t&&delete r[e],!t})),a.push(e),r[e]=t||e,$.publish("solr/query"))},label:function(e,t){return ITA.util.get(t.value.label,e+"."+ITA.solr.lang,e)}},render:function(e){var t=this.fn,r=void 0,a=(e.json.value.label,function(e,t,n){if(4===e.readyState){if(200===e.status)return!1;"Error HTTP: "+n}else 0===e.readyState?"Error de Red : superados "+r.timeout+" milisegundos de tiempo de espera":"Error desconocido: ";return console.warn("Error AJAX: ",e,t,n),!0}),n=function(){return o(r.solrUrl+"select?"+$.param(r.query,!0)+"&json.wrf=?")},o=function(e){return r.nofilternoquery&&0===r.query.fq.length?e.replace("&rows="+r.query.rows,"&rows=0"):e},i=function(e){if("vue_solr_documents"in ITA.widget){var t=ITA.widget.vue_solr_documents.data;t.docs=e.response.docs,t.highlighting=e.highlighting||{}}},s=function(){return r.query.start=0,$.ajax({dataType:"json",url:n(),xhrFields:{withCredentials:!0},timeout:r.timeout,error:a}).done(function(e,t,n){a(n,t)||(r.response=e,i(e),$.publish("solr/load",[e]))})},l=function(e,t){if(t&&"responseHeader"in t){var n=t.responseHeader.params,a={fq:n.fq,q:n.q,alias:JSON.stringify(ITA.solr.alias)};history.replaceState(null,null,(r=$.param(a,!0),"#"+btoa(r)))}var r};return window.onhashchange=function(){console.warn("onhashchange")},$("body").on("click","[data-fq]",function(){t.set_fq_and_query(this.getAttribute("data-fq"),this.getAttribute("data-fq-alias"))}),r=ITA.solr=Object.assign({alias:{fq:{}},timeout:2e4,response:{response:{docs:[],numFound:0,start:0}}},e.json.value),"solrUrl"in ITA.project&&(r.solrUrl=ITA.project.solrUrl),"fq"in ITA.project&&(r.query.fq=ITA.project.fq),r.query.fq||(r.query.fq=[]),function(e){var t,n=document.location.hash;if(n)try{var a=(t=n,atob(t.slice(1))).split("&").reduce(function(e,t,n,a){var r=t.split("="),o=_slicedToArray(r,2),i=o[0],s=o[1];return i=decodeURIComponent(i.replace(/\+/g," ")),s=decodeURIComponent(s.replace(/\+/g," ")),e[i]=i in e?[].concat(e[i],s):s,e},{});e.query.fq=a.fq?ITA.util.castArray(a.fq):[],e.query.q=a.q,e.alias=JSON.parse(a.alias)}catch(e){history.replaceState(null,null,"")}}(r),$("#lang").on("change",function(e){ITA.lang=r.lang=$(this).val(),$("html").attr("lang",ITA.lang),$.publish("solr/query")}),r.layerLoading=function(e){e.destroy,e.target,e.label},$.subscribe("solr/rendered",function(e,t){}),$.subscribe("solr/reload",s),$.subscribe("solr/query",s),$.subscribe("solr/query/docs",function(){return $.ajax({dataType:"json",url:n().replace("facet=true","facet=false"),xhrFields:{withCredentials:!0}}).done(function(t){ITA.util.isEmpty(t)||Object.keys(t).forEach(function(e){r.response[e]=t[e]}),i(t),$.publish("solr/load/docs",[t])}).fail(function(e,t,n){console.warn(e,t,n)})}),$.subscribe("solr/update",function(e,t){var n=[];return n[0]=t,$.ajax({dataType:"json",url:r.solrUrl+"update?commit=true",type:"POST",data:JSON.stringify(n),xhrFields:{withCredentials:!0}}).always(function(e){$.publish("solr/query")})}),$.subscribe("solr/delete",function(e,t){var n=[];n[0]=t;var a=n.map(function(e,t){for(var n in e)return"<query>"+n+':"'+e[n]+'"</query>'});return $.ajax({dataType:"json",url:r.solrUrl+"update?commit=true&stream.body=<delete>"+a.join("")+"</delete>",type:"POST",xhrFields:{withCredentials:!0}}).always(function(e){$.publish("solr/query")})}),$.subscribe("solr/load",l),$.subscribe("solr/load/docs",l),r.reload_interval&&function e(){setTimeout(function(){$.publish("solr/reload"),e()},r.reload_interval)}(),$.subscribe("vmp.rendered",function(){$.publish("solr/init"),$.publish("solr/query")}),[ITA.$_DERERRED,null]}},ITA.widget.solr_search_combobox={dependencies:{css:["vendor/select2/v4.0.6-rc.1/select2.min.css","vendor/select2/v4.0.6-rc.1/select2-bootstrap.min.css"],js:["js/widgets/ita.items.select.min.js","vendor/select2/v4.0.6-rc.1/select2.full.min.js","vendor/select2/v4.0.6-rc.1/i18n/es.js"]},render:function(e){var t=e.id,i=e.json,n=e.$target,a=i.value.classname||"",s=$('<div class="solr_search_combobox '+a+'"></div>'),l=ITA.widget,c=function(e){return l.solr_query.fn.label(e,i)};s.on("click","h4",function(){this.classList.toggle("collapsed")}),s.on("click","a",function(){l.solr_query.fn.set_fq_and_query($(this).data("fq"))});var r=".solr_search_combobox."+t;return $.unsubscribe("solr/load"+r),$.subscribe("solr/load"+r,function(e,t){ITA.util.empty(s[0]);var a=i.value.facet,n=ITA.util.get(t,(i.value.where||"facet_counts.facet_fields")+"."+a,{}),r={q:ITA.solr.query.q},o=$.param({fq:ITA.solr.query.fq},!0);ITA.util.isEmpty(n)?(console.warn('solr_search_list: ERROR FACET: "'+a+'" no existe en datos recibidos.'),s.hide()):(s.html('<h4 title="'+a+'">'+c(a)+":</h4>"),$('<select class="form-control js-data-example-ajax" style="width:100%"></select>').appendTo(s).select2({ajax:{url:ITA.solr.solrUrl+"select?json.wrf=?"+(o?"&"+o:""),dataType:"json",delay:250,data:function(e){var t={page:e.page,"facet.field":a,rows:0,wt:"json",facet:!0,"json.nl":"arrarr"};return t["f."+a+".facet.offset"]=15*e.page||0,t["f."+a+".facet.contains"]=e.term,t["f."+a+".facet.contains.ignoreCase"]=!0,t["f."+a+".facet.limit"]=15,t["f."+a+".facet.mincount"]=1,t["f."+a+".facet.sort"]="count",Object.assign(r,t)},processResults:function(e,n){return n.page=n.page||0,{results:e.facet_counts.facet_fields[a].map(function(e){var t=new RegExp(n.term,"gi");return{id:e[0],text:e[0].replace(t,'<strong style="color:#a00">'+n.term.toUpperCase()+"</strong>")+" ("+e[1]+")"}}),pagination:{more:30*n.page<e.response.numFound}}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1}).on("select2:select",function(e){l.solr_query.fn.set_fq_and_query(a+':"'+this.value+'"',c(a)+':"'+this.value+'"')}),s.show())}),s.appendTo(n),[ITA.$_RESOLVED,s]}},ITA.widget.solr_search_fq={render:function(e){var t=e.id,n=e.json,a=e.$target,r=n.value,o=r.field,i=r.fields||[r.field],s=r.label||o||i.join(","),l=o||s,c=r.layout||"horizontal",u={},d=$('<div class="solr_search_fq"></div>').on("keydown",":input",function(e){var t,n,a;13===e.keyCode&&(t=e,n=u.fq,a=t.currentTarget.value,u.fq=i.map(function(e){return e+":("+a+")"}).join(" OR "),u.value=a,ITA.widget.solr_query.fn.set_q_fq_and_query(u.fq,s+": "+a,n,u))}),p=".solr_search_fq."+t;return $.unsubscribe("solr/load"+p),$.subscribe("solr/load"+p,function(e,t){var n=ITA.util.castArray(ITA.util.get(t,"responseHeader.params.fq",""));u.valueFound=n.includes(u.fq)?u.value:"";var a={mode:"input",value:{label:s+":",layout:c,titlelabel:l,titleinput:l,size:"sm",value:u.valueFound}};return ITA.util.empty(d[0]),ITA.renderComponent(null,a,d)}),d.appendTo(a),[ITA.$_RESOLVED,d]}},ITA.widget.solr_search_googlechart={render:function(e){var t=e.id,n=e.json,a=e.$target,r=n.value.classname||"",o=$('<div class="solr_search_googlechart '+r+'"></div>'),i=function(e){return u.solr_query.fn.label(e,n)},s=n.value.facet,l=n.value.component,c=l.id,u=ITA.widget;s||console.error("solr_search_googlechart: ERROR: falta definir (.hjson) campo 'value.field' en el objeto: ",n),c||console.error('solr_search_googlechart: ERROR: falta definir un "id" en su JSON del componente',l);var d=".solr_search_googlechart."+t;return $.unsubscribe("solr/load"+d),$.subscribe("solr/load"+d,function(e,t){var a=Object.entries(ITA.util.get(t,(n.value.where||"facet_counts.facet_fields")+"."+s,{"No existen datos":0}));return l.value.data=[["dato","valor"]].concat(a),l.value.options.title=i(s),ITA.util.empty(o[0]),ITA.renderComponent(null,l,o).then(function(e){if(1<a.length){var n=u.googlechart.graphs[c];google.visualization.events.addListener(n,"select",function(){var e=n.getSelection()[0].row;if(void 0!==e){var t=a[e][0];u.solr_query.fn.set_fq_and_query(s+':"'+t+'"',i(s)+": "+t)}})}return e})}),o.appendTo(a),[ITA.$_RESOLVED,o]}},ITA.widget.solr_search_list={render:function(e){var t=e.id,d=e.index,p=e.json,n=e.$target,a=p.value.classname||"",f=$('<div class="solr_search_list '+a+'"></div>'),m=function(e){return ITA.widget.solr_query.fn.label(e,p)},g=p.value.facet,r=/"(.+)"/,o=/(\[|\{)(.+) TO (.+)(\]|\{)/,v=function(e){var t=e.match(o);return t&&t[0]},h=function(e){return v(e)||(t=e.match(r))&&t[1];var t},b=function(e,t){var n=void 0===t,a=p.value[n?"format_alias":"format"]||{},r=n?"":'<span class="pull-right">'+t+"</span>";return _.template(a[e]||a["*"]||r+e)({facetValue:e,facetNum:t})};f.on("click","h4",function(){this.classList.toggle("collapsed")});var i=".solr_search_list."+t;return $.unsubscribe("solr/load"+i),$.subscribe("solr/load"+i,function(e,t){var n,a,r,o,i=(n=g,a=t.responseHeader.params.fq,r=void 0===a?[]:a,o=n+":",ITA.util.castArray(r).filter(function(e){return 0===e.indexOf(o)}).map(function(e){return e.substr(o.length)})),s=ITA.util.get(t,(p.value.where||"facet_counts.facet_fields")+"."+g,{}),l=null;if(i.length&&(l=h(i[0])),ITA.util.isEmpty(s))console.warn('solr_search_list: ERROR FACET: "'+g+'" no existe en datos recibidos.'),f.hide();else{var c=[];ITA.util.forEach(s,function(e,t){var n,a,r;0<e&&c.push('<a href="#" data-fq=\''+(v(r=t)?g+":"+r:g+':"'+r+'"')+"' data-fq-alias='"+m(g)+": "+b(t)+'\' class="list-group-item" '+(n="selected",t===l?n:a||"")+">"+b(t,e)+"</a>")}),f[0].innerHTML='<h4 title="'+g+'">'+m(g)+':</h4><div class="list-group" tabindex="'+d+'">'+(1<c.length?'<a class="list-group-item">&nbsp;</a>':"")+c.join("")+"</div>";var u=f[0].querySelector("a[selected]");u&&u.scrollIntoView(),f.show()}}),f.appendTo(n),[ITA.$_RESOLVED,f]}},ITA.widget.solr_search_range={render:function(e){var t=e.id,m=e.json,n=e.$target,a=m.value.classname||"",g=$('<div class="solr_search_range '+a+'"></div>'),v=m.value.facet,r=/"(.+)"/,o=/\[(.+) TO (.+)\]/,h=function(e){return(n=e.match(o))&&n[0]||(t=e.match(r))&&t[1];var t,n},b=ITA.widget,y=function(e){return b.solr_query.fn.label(e,m)},i=".solr_search_range."+t;return $.unsubscribe("solr/load"+i),$.subscribe("solr/load"+i,function(e,t){var n,a,r,o,i=(n=v,a=t.responseHeader.params.fq,r=void 0===a?[]:a,o=n+":",ITA.util.castArray(r).filter(function(e){return 0===e.indexOf(o)}).map(function(e){return e.substr(o.length)})),s=ITA.util.get(t,(m.value.where||"facet_counts.facet_fields")+"."+v,{}),l=null,c="",u="";if(i.length){l=h(i[0]);var d=JSON.parse(l.replace(" TO ",",")),p=_slicedToArray(d,2);c=p[0],u=p[1]}if(ITA.util.isEmpty(s))console.warn('solr_search_list: ERROR FACET: "'+v+'" no existe en datos recibidos.'),g.hide();else{g[0].innerHTML='<h4 title="'+v+'">'+y(v)+":</h4>",Object.keys(s),g[0].querySelector("input");var f=function(n){return Object.entries(s).map(function(e,t){return'<option value="'+e[0]+'" '+(e[0]==n?"selected":"")+">"+e[0]+" "+(e[1],"")+"</option>"}).join("")};g.append('<div class="row"><div class="col-md-6"><div class="-input-group -input-group-sm"><span class="-input-group-addon" id="sizing-addon1">'+y("from")+' </span><select type="text" class="form-control input-sm" style="padding-left:.2em;padding-right:0" placeholder="Username" aria-describedby="sizing-addon1"><option value=""></option>'+f(c)+'</select></div></div><div class="col-md-6"><div class="-input-group -input-group-sm"><span class="-input-group-addon" id="sizing-addon2">'+y("to")+' </span><select type="text" class="form-control input-sm" style="padding-left:.2em;padding-right:0" placeholder="Username" aria-describedby="sizing-addon2"><option value=""></option>'+f(u)+"</select></div></div></div>"),g.on("change","select",function(){var e=g.find("select"),t=e.eq(0)[0].value,n=e.eq(1)[0].value;if(""!==t&&""!==n){if(n<t){var a=[t,n];n=a[0],t=a[1]}b.solr_query.fn.set_fq_and_query(v+":["+t+" TO "+n+"]",y(v)+": "+t+" al "+n,v+":")}})}}),g.appendTo(n),[ITA.$_RESOLVED,g]}},ITA.widget.solr_search_tree={destroy:function(e,t){if("jstree"in window)return window.jstree.destroy(e)},render:function(e){var t=e.id,a=e.index,l=e.json,c=e.$target,n=l.value.classname||"",u=$('<div class="solr_sea.rch_tree '+n+'"></div>'),d=this,p=function(e){return ITA.widget.solr_query.fn.label(e,l)},r=".solr_search_tree."+t;return $.unsubscribe("solr/load"+r),$.subscribe("solr/load"+r,function(e,t){d.destroy(c,a),ITA.util.empty(u[0]);var r=l.value.facet,n=ITA.util.get(t,"facet_counts.facet_fields."+r,{});if(ITA.util.isEmpty(n))console.warn('solr_search_tree: ERROR FACET: "'+r+'" no existe en datos recibidos.');else{var o,i={},s=[];ITA.util.forEach(n,function(e,t){var n=t.split("]")[0].split("-")[1].split("/"),a=n.length;i[n[a-1]]=!0,1<a&&!i[n[a-2]]?console.warn('error en árbol: "'+r+'". "'+n[a-2]+'" no existe como padre de "'+n[a-1]+'" : '+t):(o=p(n[a-1].split("_").join(" ")),s.push({id:n[a-1],parent:1<a?n[a-2]:"#",text:o+" ("+e+")",a_attr:{"data-fq-alias":p(r)+':"'+o+'"',"data-fq":r+':"'+t+'"'}}))}),u.append('<h4 title="'+r+'">'+p(r)+":</h4>"),ITA.renderComponent(null,{mode:"jstree",value:{core:{data:s,check_callback:!0,themes:{name:"proton",responsive:!0}},plugins:["search"]}},u),s=i=null}}),u.appendTo(c),[ITA.$_RESOLVED,u]}},ITA.widget.solr_sort={destroy:function(e,t){console.warn("destroy sort")},render:function(e){var s,t=e.id,n=e.json,a=e.$target,l=n.value,c=l.field,u=l.label||c,d=c||u,p=function(){var e=f.find("select");e.length&&e.data("select2")&&e.detach().select2().select2("destroy")},f=$('<div class="solr_sort"></div>').on("select2:select select2:unselect","select",function(e){var t=$(this).val()||"";t.constructor===Array&&(t=t.join(",")),s.sort!==t&&(s.sort=t,$.publish("solr/query/docs"))});return $.unsubscribe("solr/init.solr_sort."+t),$.subscribe("solr/init.solr_sort."+t,function(e,t){var n=(s=ITA.solr.query).sort||"",a=(l.fields||s.fl||"").split(","),r=n.split(",").map(function(e){return e.trim()}),o={};a.forEach(function(e){o[e+" asc"]=e+" asc",o[e+" desc"]=e+" desc"});var i={mode:"select2",value:{label:(u||c)+":",children:o,layout:"horizontal",multiple:!0,titlelabel:d,titleinput:d,size:"sm",value:r,tags:!1}};return p(),ITA.util.empty(f[0]),ITA.renderComponent(null,i,f)}),f.appendTo(a),[ITA.$_RESOLVED,f]}},function(e){var t="speech_recognition";ITA.widget[t]={},ITA.util[t]=function(e,r){if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){$(".ita-microphone").remove();var t,n,a={init:"Pulse para empezar a reconocer su voz",record:"Grabando voz...",allow:'Pulse el botón "Permitir" de arriba para activar su micrófono.',speaknow:"Hable ahora.",nomicro:"No se encontró micrófono. Asegúrese de que tiene uno instalado y que su configuración es la correcta",nospeech:"No se ha detectado la voz. Puede que necesite ajustar la configuración del micrófono",denied:"Permiso para usar el micrófono denegado.",blocked:"Permiso para usar el micrófono bloqueado. Permission to use microphone is blocked. Para cambiarlo, vaya a chrome://settings/contentExceptions#media-stream"},o=!1,i="",s=function(e,t){t&&l.prop("title",a[t]),e&&l.removeClass("text-info text-danger text-muted animated").addClass(e)},l=$('<i class="ita-microphone fa fa-microphone infinite rubberBand" aria-hidden="true"></i>').css({position:"absolute",right:".4em","vertical-align":"middle","font-size":"1.5em",top:".4em",cursor:"pointer"}).on("click",function(e){o?u.stop():(u.lang="es-ES",u.start(),n=!1,s("text-muted","allow"),t=e.timeStamp)}).insertBefore(e),c=c||webkitSpeechRecognition,u=new c;s("text-info","init"),u.continuous=!0,u.interimResults=!0,u.onstart=function(){o=!(i=""),s("text-danger animated","record"),"onstart"in r&&r.onstart()},u.onresult=function(e){for(var t=[],n=e.resultIndex,a=e.results.length;n<a;++n)t.push(e.results[n][0].transcript);i=t.join(""),"onresult"in r&&r.onresult(i)},u.onend=function(){o=!1,n||(s("text-info"),0<i.length&&s(null,"init"),"onend"in r&&r.onend(i))},u.onerror=function(e){switch(e.error){case"no-speech":s("text-info","nospeech"),n=!0;break;case"audio-capture":s("text-info","nomicro"),n=!0;break;case"not-allowed":s(null,e.timeStamp-t<100?"blocked":"denied"),n=!0}"onerror"in r&&r.onerror(e)}}else;}}(),ITA.widget.tab={template:function(e){var t=e.id,n=e.classname,a=void 0===n?"":n,r=e.children,o=e.items,i=e.mode,s=void 0===i?"tabs":i,l=e.justified,c=e.properties,u=void 0===c?{}:c,d=e.fade,p=void 0!==d&&d;r=r||o,l=l||u.justified?" nav-justified":"",p=p?" fade ":"";var f=[],m=[],g=ITA.util.tag,v=ITA.util.if;return r.forEach(function(e,t){var n=e.properties,a=void 0===n?{}:n,r=e.id,o=e.title,i=e.label,s=e.name,l=a.icon?'<i class="'+a.icon+'"></i> ':"";f.push('<li role="presentation"'+v(0===t,' class="active"')+'><a href="#'+r+'" aria-controls="'+r+'" role="tab" data-toggle="tab"'+g("title",o)+">"+l+(i||s)+"</a></li>"),m.push('<div role="tabpanel" class="panel-body tab-pane '+p+v(0===t,v(p," in ")+" active")+'" id="'+r+'" style="position:relative"></div>')}),'<div id="'+t+'" class="vmp-mode-tab '+a+'"> <ul class="nav nav-'+s+l+'" role="tablist">'+f.join("")+' </ul> <div class="tab-content">'+m.join("")+" </div> </div>"},$_mounted:function(e){return $(e.querySelectorAll("a[data-toggle=tab]")).on("shown.bs.tab",function(e){$.publish("resizeend")}).promise()},render:ITA.util.render},ITA.widget.table={dependencies:{css:["<style>.text-nowrap{white-space: nowrap;}/*.table-header-rotated {margin-top: 2em;}*/.table-header-rotated th{white-space: nowrap;position: relative;padding:0 !important;border: none !important;}.table-header-rotated-container{position: absolute;bottom: 0;left: 100%;transform-origin: left bottom;transform: translate3d(0, 1px, 0) rotate(-45deg);border-bottom: 1px solid #ccc;line-height: 1em;}</style>"]},default:{id:null,col:[],thead:[],tbody:[],tfoot:[],caption:"",classname:{thead:"",tbody:"",tfoot:"",table:""},style:{thead:"",tbody:"",tfoot:"",table:""},classnameCaption:""},template:function(e){var t=e.id,n=e.classname,a=e.style,r=e.col,o=e.thead,i=e.tbody,s=e.tfoot,l=e.caption,c=e.classnameCaption,u=ITA.util.tag,d=(ITA.util.if,u("class",n.thead)),p=u("class",n.tbody),f=u("class",n.tfoot),m=n.table||"",g=u("style",a.thead),v=u("style",a.tbody),h=u("style",a.tfoot),b=u("style",a.table),y="table-header-rotated",T=d.includes(y)?['<div class="'+y+'-container">',"</div>"]:["",""];return c=n.caption||c,"<table "+(t=u("id",t))+' class="table table-condensed table-stripe table-bordered '+m+'" '+b+">"+(0<l.length?'<caption class="'+c+'">'+l+"</caption>":"")+"<colgroup>"+(r.length?r.map(function(e){return"<col "+e+"/>"}):i[0]?i[0].map(function(e){return"<col/>"}):[]).join("")+"</colgroup>"+(o.length?"<thead"+d+g+">"+o.map(function(e){return"<tr>"+e.map(function(e){return Array.isArray(e)?"<th "+e[0]+">"+T[0]+e[1]+T[1]+"</th>":"<th>"+T[0]+e+T[1]+"</th>"}).join("")+"</tr>"}).join("")+"</thead>":"")+"<tbody"+p+v+">"+i.map(function(e){return"<tr>"+e.map(function(e){return Array.isArray(e)?"<"+(e[2]||"td")+" "+e[0]+">"+e[1]+"</"+(e[2]||"td")+">":"<td>"+e+"</td>"}).join("")+"</tr>"}).join("")+"</tbody>"+(s.length?"<tfoot"+f+h+">"+s.map(function(e){return"<tr>"+e.map(function(e){return Array.isArray(e)?"<td "+e[0]+">"+e[1]+"</td>":"<td>"+e+"</td>"}).join("")+"</tr>"}).join("")+"</tfoot>":"")+"</table>"},beforeMount:function(e){e.classList.add("table-ita")},render:ITA.util.render},ITA.widget.value={template:function(e){var t=e.id,n=e.value,a=document.createElement("div");a.innerHTML=null==n?"":n;var r=n&&n.trim().startsWith("<")&&1===a.childElementCount?a.firstElementChild:a;return r.hasAttribute("id")||r.setAttribute("id",t),r},render:ITA.util.render},ITA.widget.vue_solr_documents={dependencies:{js:["https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.min.js"]},data:{},render:function(e){var t=this,n=e.id,a=e.json,r=e.$target,o=ITA.util,i=ITA.solr,s=".vue_solr_documents."+n;return $.unsubscribe("solr/load"+s),$.subscribe("solr/load"+s,function(){$.unsubscribe("solr/load"+s),t.data=i.response.response,t.data.highlighting=i.response.highlighting,t.data.lang=i.lang;var e=ITA.util.append(r[0],a.value.template);new Vue({el:e,data:t.data,methods:{highlight:function(e,t){return o.get(this.highlighting,e+"."+t+".0","")},scrollTop:function(e){e.target.classList.contains("scroll-top")&&$("html, body").animate({scrollTop:0},"fast")},initPopover:function(){var e=this.$el.querySelectorAll('[data-toggle="popover"]');$(e).popover()}},filters:{date:function(e){return new Date(e).toLocaleString(t.data.lang).split(" ")[0]},translate:function(e){return o.get(a.value,"label."+e+"."+t.data.lang,e)},extType:function(e){var t=e.toLowerCase();return t.includes(".pdf")?"PDF":t.includes(".doc")?"Ms WORD":"URL"},extIcon:function(e){var t=e.toLowerCase();return"fa fa-"+(t.includes(".pdf")?"file-pdf-o":t.includes(".doc")?"doc":"external-link")},list:function(e){return Array.isArray(e)?"<ol><li>"+e.join("</li><li>")+"</li><ol>":""},length:function(e){return o.castArray(e).length}},mounted:function(){this.initPopover()},updated:function(){this.initPopover()}})}),ITA.$_RESOLVED}},function(e){var a,t="wordcloud2";e[t]={dependencies:{js:["https://unpkg.com/wordcloud@1.1.0/src/wordcloud2.js"],css:["<style>.vmp-mode-wordcloud2 span:hover{background-color: rgba(255, 255, 255, 0.8);box-shadow: 0 0 5px 2px rgba(0,0,0,.3);/*z-index: 1;*/cursor:pointer;}</style>"]},defaults:{list:[],fontFamily:"'Trebuchet MS', 'Heiti TC', 'Arial Unicode MS', 'Droid Fallback Sans', sans-serif",fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"rgba(255,255,255,0)",gridSize:8,origin:null,drawOutOfBound:!1,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,hover:null,click:null,debug:!1},render:function(i){var s,l=$('<div id="'+i.id+'"></div>').css("position","relative").appendTo(i.$target),c=Object.assign({},a,i.json.value.options),u=c.debug,d=c.maxValue,p=c.gridSize,e=i.json.value.data.map(function(e){return e[1]}),r=ITA.util.minN(e),o=ITA.util.maxN(e),t=function(e){var t=i.$target[0].offsetWidth,n=c.height||.65*t,a=l[0];void 0===e&&"function"!=typeof c.weightFactor&&(c.weightFactor=(t+2570)/(c.list.length+284.8)),a.style.width=t+"px","auto"===n||"100%"===n?ITA.util.set_elem_height_to_avoid_parents_scrollbars(a,10):a.style.height=n+"px";var r=i.$target[0].offsetHeight,o=Math.min(1,r*t/5e5);c.gridSize=Math.floor(p*o),c.maxValue=Math.floor(d*o),WordCloud(a,c),u&&s.val(JSON.stringify(_.omit(c,"list"),null,4))};if(e=null,c.list=i.json.value.data.map(function(e){return{word:e[0],weight:e[1],attributes:{title:e[0]+" ("+e[1]+")"}}}),c.click=function(e,t,n){$.publish("wordcloud2/click."+i.json.id,{item:e,dimension:t,event:n})},c.maxValue&&c.minValue&&(c.weightFactor=function(e){return t=e,n=c.maxValue,a=c.minValue,r===o?Math.round((n+a)/3):Math.floor((t-r)*(n-a)/(o-r)+a);var t,n,a}),u){var n=$("<div></div>").prependTo(i.$target);s=$("<textarea></textarea>").prependTo(n).on("change",function(){c=JSON.parse(s.val()),t(!0)}),$('<select><option value="circle">shape: "circle"</option><option value="triangle">shape: "triangle"</option><option value="triangle-forward">shape: "triangle-forward"</option><option value="diamond">shape: "diamond"</option><option value="cardioid">shape: "cardioid"</option><option value="pentagon">shape: "pentagon"</option><option value="star">shape: "star"</option></select>').prependTo(n).on("change",function(){c.shape=this.value,t()}),$('<button class="btn btn-default btn-sm"><i class="fa fa-font"></i> Disminuye</button>').prependTo(n).on("click",function(){c.weightFactor<=.1||(c.weightFactor-=.1,t(!0))}),$('<button class="btn btn-default btn-sm"><i class="fa fa-font fa-lg"></i> Agranda</button>').prependTo(n).on("click",function(){c.weightFactor+=.1,t(!0)}),$('<button class="btn btn-default btn-sm"><i class="fa fa-compress"></i> Junta</button>').prependTo(n).on("click",function(){c.gridSize<=2||(c.gridSize-=1,t())}),$('<button class="btn btn-default btn-sm"><i class="fa fa-expand"></i> Dispersa</button>').prependTo(n).on("click",function(){c.gridSize+=1,t()})}return $.unsubscribe("resizeend.wordcloud2."+i.id),$.subscribe("resizeend.wordcloud2."+i.id,function(){t()}),$.publish("resizeend.wordcloud2."+i.id),[l.promise(),l]}},a=e[t].defaults}(ITA.widget);